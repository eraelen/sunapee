<!DOCTYPE html>
<html>
<head>
  <title>depcomp</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../", thisFile = "node_modules/sqlite3/deps/sqlite3/depcomp", defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#gcc-3-implements-dependency-tracking-that-does-exactly-what">gcc 3 implements dependency tracking that does exactly what</a>
      </div>
      <div class="heading h1">
        <a href="#we-want.--yay---note--for-some-reason-libtool-1.4-doesn-t-like">we want.  Yay!  Note: for some reason libtool 1.4 doesn't like</a>
      </div>
      <div class="heading h1">
        <a href="#it-if--md--mp-comes-after-the--mf-stuff.--hmm.">it if -MD -MP comes after the -MF stuff.  Hmm.</a>
      </div>
      <div class="heading h1">
        <a href="#there-are-various-ways-to-get-dependency-output-from-gcc.--here-s">There are various ways to get dependency output from gcc.  Here's</a>
      </div>
      <div class="heading h1">
        <a href="#why-we-pick-this-rather-obscure-method-">why we pick this rather obscure method:</a>
      </div>
      <div class="heading h1">
        <a href="#--don-t-want-to-use--md-because-we-d-like-the-dependencies-to-end">- Don't want to use -MD because we'd like the dependencies to end</a>
      </div>
      <div class="heading h1">
        <a href="#up-in-a-subdir.--having-to-rename-by-hand-is-ugly.">up in a subdir.  Having to rename by hand is ugly.</a>
      </div>
      <div class="heading h1">
        <a href="#-we-might-end-up-doing-this-anyway-to-support-other-compilers.-">(We might end up doing this anyway to support other compilers.)</a>
      </div>
      <div class="heading h1">
        <a href="#--the-dependencies_output-environment-variable-makes-gcc-act-like">- The DEPENDENCIES_OUTPUT environment variable makes gcc act like</a>
      </div>
      <div class="heading h1">
        <a href="#-mm--not--m--despite-what-the-docs-say-.">-MM, not -M (despite what the docs say).</a>
      </div>
      <div class="heading h1">
        <a href="#--using--m-directly-means-running-the-compiler-twice--even-worse">- Using -M directly means running the compiler twice (even worse</a>
      </div>
      <div class="heading h1">
        <a href="#than-renaming-.">than renaming).</a>
      </div>
      <div class="heading h1">
        <a href="#the-second--e-expression-handles-dos-style-file-names-with-drive-letters.">The second -e expression handles DOS-style file names with drive letters.</a>
      </div>
      <div class="heading h1">
        <a href="#this-next-piece-of-magic-avoids-the--deleted-header-file--problem.">This next piece of magic avoids the `deleted header file' problem.</a>
      </div>
      <div class="heading h1">
        <a href="#the-problem-is-that-when-a-header-file-which-appears-in-a-.p-file">The problem is that when a header file which appears in a .P file</a>
      </div>
      <div class="heading h1">
        <a href="#is-deleted--the-dependency-causes-make-to-die--because-there-is">is deleted, the dependency causes make to die (because there is</a>
      </div>
      <div class="heading h1">
        <a href="#typically-no-way-to-rebuild-the-header-.--we-avoid-this-by-adding">typically no way to rebuild the header).  We avoid this by adding</a>
      </div>
      <div class="heading h1">
        <a href="#dummy-dependencies-for-each-header-file.--too-bad-gcc-doesn-t-do">dummy dependencies for each header file.  Too bad gcc doesn't do</a>
      </div>
      <div class="heading h1">
        <a href="#this-for-us-directly.">this for us directly.</a>
      </div>
      <div class="heading h1">
        <a href="#some-versions-of-gcc-put-a-space-before-the----.--on-the-theory">Some versions of gcc put a space before the `:'.  On the theory</a>
      </div>
      <div class="heading h1">
        <a href="#that-the-space-means-something--we-add-a-space-to-the-output-as">that the space means something, we add a space to the output as</a>
      </div>
      <div class="heading h1">
        <a href="#well.">well.</a>
      </div>
      <div class="heading h1">
        <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">Some versions of the HPUX 10.20 sed can't process this invocation</a>
      </div>
      <div class="heading h1">
        <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">correctly.  Breaking it into two sed invocations is a workaround.</a>
      </div>
      <div class="heading h1">
        <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">Some versions of the HPUX 10.20 sed can't process this invocation</a>
      </div>
      <div class="heading h1">
        <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">correctly.  Breaking it into two sed invocations is a workaround.</a>
      </div>
      <div class="heading h1">
        <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">Some versions of the HPUX 10.20 sed can't process this invocation</a>
      </div>
      <div class="heading h1">
        <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">correctly.  Breaking it into two sed invocations is a workaround.</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>depcomp</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="c">#! /bin/sh</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>depcomp - compile a program generating dependencies as side-effects</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nv">scriptversion</span><span class="o">=</span>2005-07-09.11


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>Copyright (C) 1999, 2000, 2003, 2004, 2005 Free Software Foundation, Inc.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2, or (at your option)
any later version.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
02110-1301, USA.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>As a special exception to the GNU General Public License, if you
distribute this file as part of a program that contains a
configuration script generated by Autoconf, you may include it under
the same distribution terms that you use for the rest of that program.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>Originally written by Alexandre Oliva <a href="&#x6D;&#97;&#105;&#x6C;&#x74;&#x6F;:&#x6F;&#108;&#x69;&#x76;&#x61;&#x40;&#x64;cc&#x2E;u&#110;&#105;&#x63;&#97;&#x6D;p&#46;&#98;&#x72;">&#x6F;&#108;&#x69;&#x76;&#x61;&#x40;&#x64;cc&#x2E;u&#110;&#105;&#x63;&#97;&#x6D;p&#46;&#98;&#x72;</a>.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="k">case</span> <span class="nv">$1</span> in
  <span class="s1">&#39;&#39;</span><span class="o">)</span>
     <span class="nb">echo</span> <span class="s2">&quot;$0: No command.  Try \`$0 --help&#39; for more information.&quot;</span> 1&gt;&amp;2
     <span class="nb">exit </span>1;
     ;;
  -h | --h*<span class="o">)</span>
    cat <span class="s">&lt;&lt;\EOF</span>
<span class="s">Usage: depcomp [--help] [--version] PROGRAM [ARGS]</span>

<span class="s">Run PROGRAMS ARGS to compile a file, generating dependencies</span>
<span class="s">as side-effects.</span>

<span class="s">Environment variables:</span>
<span class="s">  depmode     Dependency tracking mode.</span>
<span class="s">  source      Source file read by `PROGRAMS ARGS&#39;.</span>
<span class="s">  object      Object file output by `PROGRAMS ARGS&#39;.</span>
<span class="s">  DEPDIR      directory where to store dependencies.</span>
<span class="s">  depfile     Dependency file to output.</span>
<span class="s">  tmpdepfile  Temporary file to use when outputing dependencies.</span>
<span class="s">  libtool     Whether libtool is used (yes/no).</span>

<span class="s">Report bugs to &lt;bug-automake@gnu.org&gt;.</span>
<span class="s">EOF</span>
    <span class="nb">exit</span> <span class="nv">$?</span>
    ;;
  -v | --v*<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&quot;depcomp $scriptversion&quot;</span>
    <span class="nb">exit</span> <span class="nv">$?</span>
    ;;
<span class="k">esac</span>

<span class="k">if </span><span class="nb">test</span> -z <span class="s2">&quot;$depmode&quot;</span> <span class="o">||</span> <span class="nb">test</span> -z <span class="s2">&quot;$source&quot;</span> <span class="o">||</span> <span class="nb">test</span> -z <span class="s2">&quot;$object&quot;</span>; <span class="k">then</span>
<span class="k">  </span><span class="nb">echo</span> <span class="s2">&quot;depcomp: Variables source, object and depmode must be set&quot;</span> 1&gt;&amp;2
  <span class="nb">exit </span>1
<span class="k">fi</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>Dependencies for sub/bar.o or sub/bar.obj go into sub/.deps/bar.Po.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">depfile</span><span class="o">=</span><span class="k">${</span><span class="nv">depfile</span><span class="p">-</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$object&quot;</span> |
  sed <span class="s1">&#39;s|[^\\/]*$|&#39;</span><span class="k">${</span><span class="nv">DEPDIR</span><span class="p">-.deps</span><span class="k">}</span><span class="s1">&#39;/&amp;|;s|\.\([^.]*\)$|.P\1|;s|Pobj$|Po|&#39;</span><span class="sb">`</span><span class="k">}</span>
<span class="nv">tmpdepfile</span><span class="o">=</span><span class="k">${</span><span class="nv">tmpdepfile</span><span class="p">-</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$depfile&quot;</span> | sed <span class="s1">&#39;s/\.\([^.]*\)$/.T\1/&#39;</span><span class="sb">`</span><span class="k">}</span>

rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>Some modes work just like other modes, but use different flags.  We
parameterize here, but still list the modes in the big case below,
to make depend.m4 easier to write.  Note that we <em>cannot</em> use a case
here, because this file can only contain one case statement.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$depmode&quot;</span> <span class="o">=</span> hp; <span class="k">then</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>HP compiler uses -M and no extra arg.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">gccflag</span><span class="o">=</span>-M
  <span class="nv">depmode</span><span class="o">=</span>gcc
<span class="k">fi</span>

<span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$depmode&quot;</span> <span class="o">=</span> dashXmstdout; <span class="k">then</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>This is just like dashmstdout with a different argument.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
   <span class="nv">dashmflag</span><span class="o">=</span>-xM
   <span class="nv">depmode</span><span class="o">=</span>dashmstdout
<span class="k">fi</span>

<span class="k">case</span> <span class="s2">&quot;$depmode&quot;</span> in
gcc3<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="gcc-3-implements-dependency-tracking-that-does-exactly-what">
  <h1>
    <a href="#gcc-3-implements-dependency-tracking-that-does-exactly-what" class="pilcrow">&#182;</a>
    gcc 3 implements dependency tracking that does exactly what
  </h1>
</div>



<div class="pilwrap" id="we-want.--yay---note--for-some-reason-libtool-1.4-doesn-t-like">
  <h1>
    <a href="#we-want.--yay---note--for-some-reason-libtool-1.4-doesn-t-like" class="pilcrow">&#182;</a>
    we want.  Yay!  Note: for some reason libtool 1.4 doesn't like
  </h1>
</div>



<div class="pilwrap" id="it-if--md--mp-comes-after-the--mf-stuff.--hmm.">
  <h1>
    <a href="#it-if--md--mp-comes-after-the--mf-stuff.--hmm." class="pilcrow">&#182;</a>
    it if -MD -MP comes after the -MF stuff.  Hmm.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="s2">&quot;$@&quot;</span> -MT <span class="s2">&quot;$object&quot;</span> -MD -MP -MF <span class="s2">&quot;$tmpdepfile&quot;</span>
  <span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>
  <span class="k">if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
    <span class="nb">exit</span> <span class="nv">$stat</span>
  <span class="k">fi</span>
<span class="k">  </span>mv <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="s2">&quot;$depfile&quot;</span>
  ;;

gcc<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="there-are-various-ways-to-get-dependency-output-from-gcc.--here-s">
  <h1>
    <a href="#there-are-various-ways-to-get-dependency-output-from-gcc.--here-s" class="pilcrow">&#182;</a>
    There are various ways to get dependency output from gcc.  Here's
  </h1>
</div>



<div class="pilwrap" id="why-we-pick-this-rather-obscure-method-">
  <h1>
    <a href="#why-we-pick-this-rather-obscure-method-" class="pilcrow">&#182;</a>
    why we pick this rather obscure method:
  </h1>
</div>



<div class="pilwrap" id="--don-t-want-to-use--md-because-we-d-like-the-dependencies-to-end">
  <h1>
    <a href="#--don-t-want-to-use--md-because-we-d-like-the-dependencies-to-end" class="pilcrow">&#182;</a>
    - Don't want to use -MD because we'd like the dependencies to end
  </h1>
</div>



<div class="pilwrap" id="up-in-a-subdir.--having-to-rename-by-hand-is-ugly.">
  <h1>
    <a href="#up-in-a-subdir.--having-to-rename-by-hand-is-ugly." class="pilcrow">&#182;</a>
    up in a subdir.  Having to rename by hand is ugly.
  </h1>
</div>



<div class="pilwrap" id="-we-might-end-up-doing-this-anyway-to-support-other-compilers.-">
  <h1>
    <a href="#-we-might-end-up-doing-this-anyway-to-support-other-compilers.-" class="pilcrow">&#182;</a>
    (We might end up doing this anyway to support other compilers.)
  </h1>
</div>



<div class="pilwrap" id="--the-dependencies_output-environment-variable-makes-gcc-act-like">
  <h1>
    <a href="#--the-dependencies_output-environment-variable-makes-gcc-act-like" class="pilcrow">&#182;</a>
    - The DEPENDENCIES_OUTPUT environment variable makes gcc act like
  </h1>
</div>



<div class="pilwrap" id="-mm--not--m--despite-what-the-docs-say-.">
  <h1>
    <a href="#-mm--not--m--despite-what-the-docs-say-." class="pilcrow">&#182;</a>
    -MM, not -M (despite what the docs say).
  </h1>
</div>



<div class="pilwrap" id="--using--m-directly-means-running-the-compiler-twice--even-worse">
  <h1>
    <a href="#--using--m-directly-means-running-the-compiler-twice--even-worse" class="pilcrow">&#182;</a>
    - Using -M directly means running the compiler twice (even worse
  </h1>
</div>



<div class="pilwrap" id="than-renaming-.">
  <h1>
    <a href="#than-renaming-." class="pilcrow">&#182;</a>
    than renaming).
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if </span><span class="nb">test</span> -z <span class="s2">&quot;$gccflag&quot;</span>; <span class="k">then</span>
<span class="k">    </span><span class="nv">gccflag</span><span class="o">=</span>-MD,
  <span class="k">fi</span>
  <span class="s2">&quot;$@&quot;</span> -Wp,<span class="s2">&quot;$gccflag$tmpdepfile&quot;</span>
  <span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>
  <span class="k">if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
    <span class="nb">exit</span> <span class="nv">$stat</span>
  <span class="k">fi</span>
<span class="k">  </span>rm -f <span class="s2">&quot;$depfile&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;$object : \\&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  <span class="nv">alpha</span><span class="o">=</span>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="the-second--e-expression-handles-dos-style-file-names-with-drive-letters.">
  <h1>
    <a href="#the-second--e-expression-handles-dos-style-file-names-with-drive-letters." class="pilcrow">&#182;</a>
    The second -e expression handles DOS-style file names with drive letters.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  sed -e <span class="s1">&#39;s/^[^:]*: / /&#39;</span> <span class="se">\</span>
      -e <span class="s1">&#39;s/^[&#39;</span><span class="nv">$alpha</span><span class="s1">&#39;]:\/[^:]*: / /&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="this-next-piece-of-magic-avoids-the--deleted-header-file--problem.">
  <h1>
    <a href="#this-next-piece-of-magic-avoids-the--deleted-header-file--problem." class="pilcrow">&#182;</a>
    This next piece of magic avoids the `deleted header file' problem.
  </h1>
</div>



<div class="pilwrap" id="the-problem-is-that-when-a-header-file-which-appears-in-a-.p-file">
  <h1>
    <a href="#the-problem-is-that-when-a-header-file-which-appears-in-a-.p-file" class="pilcrow">&#182;</a>
    The problem is that when a header file which appears in a .P file
  </h1>
</div>



<div class="pilwrap" id="is-deleted--the-dependency-causes-make-to-die--because-there-is">
  <h1>
    <a href="#is-deleted--the-dependency-causes-make-to-die--because-there-is" class="pilcrow">&#182;</a>
    is deleted, the dependency causes make to die (because there is
  </h1>
</div>



<div class="pilwrap" id="typically-no-way-to-rebuild-the-header-.--we-avoid-this-by-adding">
  <h1>
    <a href="#typically-no-way-to-rebuild-the-header-.--we-avoid-this-by-adding" class="pilcrow">&#182;</a>
    typically no way to rebuild the header).  We avoid this by adding
  </h1>
</div>



<div class="pilwrap" id="dummy-dependencies-for-each-header-file.--too-bad-gcc-doesn-t-do">
  <h1>
    <a href="#dummy-dependencies-for-each-header-file.--too-bad-gcc-doesn-t-do" class="pilcrow">&#182;</a>
    dummy dependencies for each header file.  Too bad gcc doesn't do
  </h1>
</div>



<div class="pilwrap" id="this-for-us-directly.">
  <h1>
    <a href="#this-for-us-directly." class="pilcrow">&#182;</a>
    this for us directly.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  tr <span class="s1">&#39; &#39;</span> <span class="s1">&#39;</span>
<span class="s1">&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> |

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="some-versions-of-gcc-put-a-space-before-the----.--on-the-theory">
  <h1>
    <a href="#some-versions-of-gcc-put-a-space-before-the----.--on-the-theory" class="pilcrow">&#182;</a>
    Some versions of gcc put a space before the `:'.  On the theory
  </h1>
</div>



<div class="pilwrap" id="that-the-space-means-something--we-add-a-space-to-the-output-as">
  <h1>
    <a href="#that-the-space-means-something--we-add-a-space-to-the-output-as" class="pilcrow">&#182;</a>
    that the space means something, we add a space to the output as
  </h1>
</div>



<div class="pilwrap" id="well.">
  <h1>
    <a href="#well." class="pilcrow">&#182;</a>
    well.
  </h1>
</div>



<div class="pilwrap" id="some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">
  <h1>
    <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation" class="pilcrow">&#182;</a>
    Some versions of the HPUX 10.20 sed can't process this invocation
  </h1>
</div>



<div class="pilwrap" id="correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">
  <h1>
    <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround." class="pilcrow">&#182;</a>
    correctly.  Breaking it into two sed invocations is a workaround.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    sed -e <span class="s1">&#39;s/^\\$//&#39;</span> -e <span class="s1">&#39;/^$/d&#39;</span> -e <span class="s1">&#39;/:$/d&#39;</span> | sed -e <span class="s1">&#39;s/$/ :/&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

hp<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>This case exists only to let depend.m4 do its work.  It works by
looking at the text of this script.  This case will never be run,
since it is checked for above.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nb">exit </span>1
  ;;

sgi<span class="o">)</span>
  <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>
    <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;-Wp,-MDupdate,$tmpdepfile&quot;</span>
  <span class="k">else</span>
    <span class="s2">&quot;$@&quot;</span> -MDupdate <span class="s2">&quot;$tmpdepfile&quot;</span>
  <span class="k">fi</span>
<span class="k">  </span><span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>
  <span class="k">if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
    <span class="nb">exit</span> <span class="nv">$stat</span>
  <span class="k">fi</span>
<span class="k">  </span>rm -f <span class="s2">&quot;$depfile&quot;</span>

  <span class="k">if </span><span class="nb">test</span> -f <span class="s2">&quot;$tmpdepfile&quot;</span>; <span class="k">then</span>  <span class="c"># yes, the sourcefile depend on other files</span>
    <span class="nb">echo</span> <span class="s2">&quot;$object : \\&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Clip off the initial element (the dependent).  Don't try to be
clever and replace this with sed code, as IRIX sed won't handle
lines with more than a fixed number of characters (4096 in
IRIX 6.2 sed, 8192 in IRIX 6.5).  We also remove comment lines;
the IRIX cc adds comments like `#:fec' to the end of the
dependency line.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    tr <span class="s1">&#39; &#39;</span> <span class="s1">&#39;</span>
<span class="s1">&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="se">\</span>
    | sed -e <span class="s1">&#39;s/^.*\.o://&#39;</span> -e <span class="s1">&#39;s/#.*$//&#39;</span> -e <span class="s1">&#39;/^$/ d&#39;</span> | <span class="se">\</span>
    tr <span class="s1">&#39;</span>
<span class="s1">&#39;</span> <span class="s1">&#39; &#39;</span> &gt;&gt; <span class="nv">$depfile</span>
    <span class="nb">echo</span> &gt;&gt; <span class="nv">$depfile</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>The second pass generates a dummy entry for each header file.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    tr <span class="s1">&#39; &#39;</span> <span class="s1">&#39;</span>
<span class="s1">&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="se">\</span>
   | sed -e <span class="s1">&#39;s/^.*\.o://&#39;</span> -e <span class="s1">&#39;s/#.*$//&#39;</span> -e <span class="s1">&#39;/^$/ d&#39;</span> -e <span class="s1">&#39;s/$/:/&#39;</span> <span class="se">\</span>
   &gt;&gt; <span class="nv">$depfile</span>
  <span class="k">else</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>The sourcefile does not contain any dependencies, so just
store a dummy comment line, to avoid errors with the Makefile
"include basename.Plo" scheme.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nb">echo</span> <span class="s2">&quot;#dummy&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  <span class="k">fi</span>
<span class="k">  </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

aix<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>The C for AIX Compiler uses -M and outputs the dependencies
in a .u file.  In older versions, this file always lives in the
current directory.  Also, the AIX compiler puts `$object:' at the
start of each line; $object doesn't have directory information.
Version 6 uses the directory in both cases.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">stripped</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$object&quot;</span> | sed <span class="s1">&#39;s/\(.*\)\..*$/\1/&#39;</span><span class="sb">`</span>
  <span class="nv">tmpdepfile</span><span class="o">=</span><span class="s2">&quot;$stripped.u&quot;</span>
  <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>
    <span class="s2">&quot;$@&quot;</span> -Wc,-M
  <span class="k">else</span>
    <span class="s2">&quot;$@&quot;</span> -M
  <span class="k">fi</span>
<span class="k">  </span><span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>

  <span class="k">if </span><span class="nb">test</span> -f <span class="s2">&quot;$tmpdepfile&quot;</span>; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span><span class="nv">stripped</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$stripped&quot;</span> | sed <span class="s1">&#39;s,^.*/,,&#39;</span><span class="sb">`</span>
    <span class="nv">tmpdepfile</span><span class="o">=</span><span class="s2">&quot;$stripped.u&quot;</span>
  <span class="k">fi</span>

<span class="k">  if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
    <span class="nb">exit</span> <span class="nv">$stat</span>
  <span class="k">fi</span>

<span class="k">  if </span><span class="nb">test</span> -f <span class="s2">&quot;$tmpdepfile&quot;</span>; <span class="k">then</span>
<span class="k">    </span><span class="nv">outname</span><span class="o">=</span><span class="s2">&quot;$stripped.o&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>Each line is of the form <code>foo.o: dependent.h'.
Do two passes, one to just change these to
</code>$object: dependent.h' and one to simply `dependent.h:'.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    sed -e <span class="s2">&quot;s,^$outname:,$object :,&quot;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
    sed -e <span class="s2">&quot;s,^$outname: \(.*\)$,\1:,&quot;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  <span class="k">else</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>The sourcefile does not contain any dependencies, so just
store a dummy comment line, to avoid errors with the Makefile
"include basename.Plo" scheme.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nb">echo</span> <span class="s2">&quot;#dummy&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  <span class="k">fi</span>
<span class="k">  </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

icc<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>Intel's C compiler understands `-MD -MF file'.  However on
   icc -MD -MF foo.d -c -o sub/foo.o sub/foo.c
ICC 7.0 will fill foo.d with something like
   foo.o: sub/foo.c
   foo.o: sub/foo.h
which is wrong.  We want:
   sub/foo.o: sub/foo.c
   sub/foo.o: sub/foo.h
   sub/foo.c:
   sub/foo.h:
ICC 7.1 will output
   foo.o: sub/foo.c sub/foo.h
and will wrap long lines using \ :
   foo.o: sub/foo.c ... \
    sub/foo.h ... \
    ...</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

  <span class="s2">&quot;$@&quot;</span> -MD -MF <span class="s2">&quot;$tmpdepfile&quot;</span>
  <span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>
  <span class="k">if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
  <span class="k">else</span>
<span class="k">    </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
    <span class="nb">exit</span> <span class="nv">$stat</span>
  <span class="k">fi</span>
<span class="k">  </span>rm -f <span class="s2">&quot;$depfile&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>Each line is of the form <code>foo.o: dependent.h',
or</code>foo.o: dep1.h dep2.h \', or <code>dep3.h dep4.h \'.
Do two passes, one to just change these to
</code>$object: dependent.h' and one to simply `dependent.h:'.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  sed <span class="s2">&quot;s,^[^:]*:,$object :,&quot;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>Some versions of the HPUX 10.20 sed can't process this invocation
correctly.  Breaking it into two sed invocations is a workaround.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  sed <span class="s1">&#39;s,^[^:]*: \(.*\)$,\1,;s/^\\$//;/^$/d;/:$/d&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> |
    sed -e <span class="s1">&#39;s/$/ :/&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

tru64<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>The Tru64 compiler uses -MD to generate dependencies as a side
effect.  <code>cc -MD -o foo.o ...' puts the dependencies into</code>foo.o.d'.
At least on Alpha/Redhat 6.1, Compaq CCC V6.2-504 seems to put
dependencies in `foo.d' instead, so we check for that too.
Subdirectories are respected.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
   <span class="nv">dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$object&quot;</span> | sed -e <span class="s1">&#39;s|/[^/]*$|/|&#39;</span><span class="sb">`</span>
   <span class="nb">test</span> <span class="s2">&quot;x$dir&quot;</span> <span class="o">=</span> <span class="s2">&quot;x$object&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">dir</span><span class="o">=</span>
   <span class="nv">base</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;$object&quot;</span> | sed -e <span class="s1">&#39;s|^.*/||&#39;</span> -e <span class="s1">&#39;s/\.o$//&#39;</span> -e <span class="s1">&#39;s/\.lo$//&#39;</span><span class="sb">`</span>

   <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>With Tru64 cc, shared objects can also be used to make a
static library.  This mecanism is used in libtool 1.4 series to
handle both shared and static libraries in a single compilation.
With libtool 1.4, dependencies were output in $dir.libs/$base.lo.d.</p>

<p>With libtool 1.5 this exception was removed, and libtool now
generates 2 separate objects for the 2 libraries.  These two
compilations output dependencies in in $dir.libs/$base.o.d and
in $dir$base.o.d.  We have to check for both files, because
one of the two compilations can be disabled.  We should prefer
$dir$base.o.d over $dir.libs/$base.o.d because the latter is
automatically cleaned when .libs/ is deleted, while ignoring
the former would cause a distcleancheck panic.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nv">tmpdepfile1</span><span class="o">=</span><span class="nv">$dir</span>.libs/<span class="nv">$base</span>.lo.d   <span class="c"># libtool 1.4</span>
      <span class="nv">tmpdepfile2</span><span class="o">=</span><span class="nv">$dir$base</span>.o.d          <span class="c"># libtool 1.5</span>
      <span class="nv">tmpdepfile3</span><span class="o">=</span><span class="nv">$dir</span>.libs/<span class="nv">$base</span>.o.d    <span class="c"># libtool 1.5</span>
      <span class="nv">tmpdepfile4</span><span class="o">=</span><span class="nv">$dir</span>.libs/<span class="nv">$base</span>.d      <span class="c"># Compaq CCC V6.2-504</span>
      <span class="s2">&quot;$@&quot;</span> -Wc,-MD
   <span class="k">else</span>
<span class="k">      </span><span class="nv">tmpdepfile1</span><span class="o">=</span><span class="nv">$dir$base</span>.o.d
      <span class="nv">tmpdepfile2</span><span class="o">=</span><span class="nv">$dir$base</span>.d
      <span class="nv">tmpdepfile3</span><span class="o">=</span><span class="nv">$dir$base</span>.d
      <span class="nv">tmpdepfile4</span><span class="o">=</span><span class="nv">$dir$base</span>.d
      <span class="s2">&quot;$@&quot;</span> -MD
   <span class="k">fi</span>

<span class="k">   </span><span class="nv">stat</span><span class="o">=</span><span class="nv">$?</span>
   <span class="k">if </span><span class="nb">test</span> <span class="nv">$stat</span> -eq 0; <span class="k">then</span> :
   <span class="k">else</span>
<span class="k">      </span>rm -f <span class="s2">&quot;$tmpdepfile1&quot;</span> <span class="s2">&quot;$tmpdepfile2&quot;</span> <span class="s2">&quot;$tmpdepfile3&quot;</span> <span class="s2">&quot;$tmpdepfile4&quot;</span>
      <span class="nb">exit</span> <span class="nv">$stat</span>
   <span class="k">fi</span>

<span class="k">   for </span>tmpdepfile in <span class="s2">&quot;$tmpdepfile1&quot;</span> <span class="s2">&quot;$tmpdepfile2&quot;</span> <span class="s2">&quot;$tmpdepfile3&quot;</span> <span class="s2">&quot;$tmpdepfile4&quot;</span>
   <span class="k">do</span>
<span class="k">     </span><span class="nb">test</span> -f <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
<span class="nb">   </span><span class="k">done</span>
<span class="k">   if </span><span class="nb">test</span> -f <span class="s2">&quot;$tmpdepfile&quot;</span>; <span class="k">then</span>
<span class="k">      </span>sed -e <span class="s2">&quot;s,^.*\.[a-z]*:,$object:,&quot;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>That's a tab and a space in the [].</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      sed -e <span class="s1">&#39;s,^.*\.[a-z]*:[  ]*,,&#39;</span> -e <span class="s1">&#39;s,$,:,&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
   <span class="k">else</span>
<span class="k">      </span><span class="nb">echo</span> <span class="s2">&quot;#dummy&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
   <span class="k">fi</span>
<span class="k">   </span>rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
   ;;


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>nosideeffect)
This comment above is used by automake to tell side-effect
dependency tracking mechanisms from slower ones.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

dashmstdout<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>Important note: in order to support this mode, a compiler <em>must</em>
always write the preprocessed file to stdout, regardless of -o.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="s2">&quot;$@&quot;</span> <span class="o">||</span> <span class="nb">exit</span> <span class="nv">$?</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<p>Remove the call to Libtool.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>
<span class="k">    while </span><span class="nb">test</span> <span class="nv">$1</span> !<span class="o">=</span> <span class="s1">&#39;--mode=compile&#39;</span>; <span class="k">do</span>
<span class="k">      </span><span class="nb">shift</span>
<span class="nb">    </span><span class="k">done</span>
<span class="k">    </span><span class="nb">shift</span>
<span class="nb">  </span><span class="k">fi</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Remove `-o $object'.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">IFS</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
  <span class="k">for </span>arg
  <span class="k">do</span>
<span class="k">    case</span> <span class="nv">$arg</span> in
    -o<span class="o">)</span>
      <span class="nb">shift</span>
      ;;
    <span class="nv">$object</span><span class="o">)</span>
      <span class="nb">shift</span>
      ;;
    *<span class="o">)</span>
      <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;$arg&quot;</span>
      <span class="nb">shift</span> <span class="c"># fnord</span>
      <span class="nb">shift</span> <span class="c"># $arg</span>
      ;;
    <span class="k">esac</span>
<span class="k">  done</span>

<span class="k">  </span><span class="nb">test</span> -z <span class="s2">&quot;$dashmflag&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">dashmflag</span><span class="o">=</span>-M

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>Require at least two characters before searching for <code>:'
in the target name.  This is to cope with DOS-style filenames:
a dependency such as</code>c:/foo/bar' could be seen as target `c' otherwise.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="s2">&quot;$@&quot;</span> <span class="nv">$dashmflag</span> |
    sed <span class="s1">&#39;s:^[  ]*[^: ][^:][^:]*\:[    ]*:&#39;</span><span class="s2">&quot;$object&quot;</span><span class="s1">&#39;\: :&#39;</span> &gt; <span class="s2">&quot;$tmpdepfile&quot;</span>
  rm -f <span class="s2">&quot;$depfile&quot;</span>
  cat &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  tr <span class="s1">&#39; &#39;</span> <span class="s1">&#39;</span>
<span class="s1">&#39;</span> &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> | <span class="se">\</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">
  <h1>
    <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation" class="pilcrow">&#182;</a>
    Some versions of the HPUX 10.20 sed can't process this invocation
  </h1>
</div>



<div class="pilwrap" id="correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">
  <h1>
    <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround." class="pilcrow">&#182;</a>
    correctly.  Breaking it into two sed invocations is a workaround.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    sed -e <span class="s1">&#39;s/^\\$//&#39;</span> -e <span class="s1">&#39;/^$/d&#39;</span> -e <span class="s1">&#39;/:$/d&#39;</span> | sed -e <span class="s1">&#39;s/$/ :/&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

dashXmstdout<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>This case only exists to satisfy depend.m4.  It is never actually
run, as this mode is specially recognized in the preamble.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nb">exit </span>1
  ;;

makedepend<span class="o">)</span>
  <span class="s2">&quot;$@&quot;</span> <span class="o">||</span> <span class="nb">exit</span> <span class="nv">$?</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>Remove any Libtool call</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>
<span class="k">    while </span><span class="nb">test</span> <span class="nv">$1</span> !<span class="o">=</span> <span class="s1">&#39;--mode=compile&#39;</span>; <span class="k">do</span>
<span class="k">      </span><span class="nb">shift</span>
<span class="nb">    </span><span class="k">done</span>
<span class="k">    </span><span class="nb">shift</span>
<span class="nb">  </span><span class="k">fi</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<p>X makedepend</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nb">shift</span>
<span class="nb">  </span><span class="nv">cleared</span><span class="o">=</span>no
  <span class="k">for </span>arg in <span class="s2">&quot;$@&quot;</span>; <span class="k">do</span>
<span class="k">    case</span> <span class="nv">$cleared</span> in
    no<span class="o">)</span>
      <span class="nb">set</span> <span class="s2">&quot;&quot;</span>; <span class="nb">shift</span>
<span class="nb">      </span><span class="nv">cleared</span><span class="o">=</span>yes ;;
    <span class="k">esac</span>
<span class="k">    case</span> <span class="s2">&quot;$arg&quot;</span> in
    -D*|-I*<span class="o">)</span>
      <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;$arg&quot;</span>; <span class="nb">shift</span> ;;

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40">&#182;</a>
</div>
<p>Strip any option that makedepend may not understand.  Remove
the object too, otherwise makedepend will parse it as a source file.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    -*|<span class="nv">$object</span><span class="o">)</span>
      ;;
    *<span class="o">)</span>
      <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;$arg&quot;</span>; <span class="nb">shift</span> ;;
    <span class="k">esac</span>
<span class="k">  done</span>
<span class="k">  </span><span class="nv">obj_suffix</span><span class="o">=</span><span class="s2">&quot;`echo $object | sed &#39;s/^.*\././&#39;`&quot;</span>
  touch <span class="s2">&quot;$tmpdepfile&quot;</span>
  <span class="k">${</span><span class="nv">MAKEDEPEND</span><span class="p">-makedepend</span><span class="k">}</span> -o<span class="s2">&quot;$obj_suffix&quot;</span> -f<span class="s2">&quot;$tmpdepfile&quot;</span> <span class="s2">&quot;$@&quot;</span>
  rm -f <span class="s2">&quot;$depfile&quot;</span>
  cat &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  sed <span class="s1">&#39;1,2d&#39;</span> <span class="s2">&quot;$tmpdepfile&quot;</span> | tr <span class="s1">&#39; &#39;</span> <span class="s1">&#39;</span>
<span class="s1">&#39;</span> | <span class="se">\</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation">
  <h1>
    <a href="#some-versions-of-the-hpux-10.20-sed-can-t-process-this-invocation" class="pilcrow">&#182;</a>
    Some versions of the HPUX 10.20 sed can't process this invocation
  </h1>
</div>



<div class="pilwrap" id="correctly.--breaking-it-into-two-sed-invocations-is-a-workaround.">
  <h1>
    <a href="#correctly.--breaking-it-into-two-sed-invocations-is-a-workaround." class="pilcrow">&#182;</a>
    correctly.  Breaking it into two sed invocations is a workaround.
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    sed -e <span class="s1">&#39;s/^\\$//&#39;</span> -e <span class="s1">&#39;/^$/d&#39;</span> -e <span class="s1">&#39;/:$/d&#39;</span> | sed -e <span class="s1">&#39;s/$/ :/&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="s2">&quot;$tmpdepfile&quot;</span>.bak
  ;;

cpp<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>Important note: in order to support this mode, a compiler <em>must</em>
always write the preprocessed file to stdout.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="s2">&quot;$@&quot;</span> <span class="o">||</span> <span class="nb">exit</span> <span class="nv">$?</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>Remove the call to Libtool.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if </span><span class="nb">test</span> <span class="s2">&quot;$libtool&quot;</span> <span class="o">=</span> yes; <span class="k">then</span>
<span class="k">    while </span><span class="nb">test</span> <span class="nv">$1</span> !<span class="o">=</span> <span class="s1">&#39;--mode=compile&#39;</span>; <span class="k">do</span>
<span class="k">      </span><span class="nb">shift</span>
<span class="nb">    </span><span class="k">done</span>
<span class="k">    </span><span class="nb">shift</span>
<span class="nb">  </span><span class="k">fi</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<p>Remove `-o $object'.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">IFS</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
  <span class="k">for </span>arg
  <span class="k">do</span>
<span class="k">    case</span> <span class="nv">$arg</span> in
    -o<span class="o">)</span>
      <span class="nb">shift</span>
      ;;
    <span class="nv">$object</span><span class="o">)</span>
      <span class="nb">shift</span>
      ;;
    *<span class="o">)</span>
      <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;$arg&quot;</span>
      <span class="nb">shift</span> <span class="c"># fnord</span>
      <span class="nb">shift</span> <span class="c"># $arg</span>
      ;;
    <span class="k">esac</span>
<span class="k">  done</span>

  <span class="s2">&quot;$@&quot;</span> -E |
    sed -n -e <span class="s1">&#39;/^# [0-9][0-9]* &quot;\([^&quot;]*\)&quot;.*/ s:: \1 \\:p&#39;</span> <span class="se">\</span>
       -e <span class="s1">&#39;/^#line [0-9][0-9]* &quot;\([^&quot;]*\)&quot;.*/ s:: \1 \\:p&#39;</span> |
    sed <span class="s1">&#39;$ s: \\$::&#39;</span> &gt; <span class="s2">&quot;$tmpdepfile&quot;</span>
  rm -f <span class="s2">&quot;$depfile&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;$object : \\&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  cat &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  sed &lt; <span class="s2">&quot;$tmpdepfile&quot;</span> <span class="s1">&#39;/^$/d;s/^ //;s/ \\$//;s/$/ :/&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

msvisualcpp<span class="o">)</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>Important note: in order to support this mode, a compiler <em>must</em>
always write the preprocessed file to stdout, regardless of -o,
because we must use -o when running libtool.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="s2">&quot;$@&quot;</span> <span class="o">||</span> <span class="nb">exit</span> <span class="nv">$?</span>
  <span class="nv">IFS</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
  <span class="k">for </span>arg
  <span class="k">do</span>
<span class="k">    case</span> <span class="s2">&quot;$arg&quot;</span> in
    <span class="s2">&quot;-Gm&quot;</span>|<span class="s2">&quot;/Gm&quot;</span>|<span class="s2">&quot;-Gi&quot;</span>|<span class="s2">&quot;/Gi&quot;</span>|<span class="s2">&quot;-ZI&quot;</span>|<span class="s2">&quot;/ZI&quot;</span><span class="o">)</span>
  <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span>
  <span class="nb">shift</span>
<span class="nb">  shift</span>
  ;;
    *<span class="o">)</span>
  <span class="nb">set </span>fnord <span class="s2">&quot;$@&quot;</span> <span class="s2">&quot;$arg&quot;</span>
  <span class="nb">shift</span>
<span class="nb">  shift</span>
  ;;
    <span class="k">esac</span>
<span class="k">  done</span>
  <span class="s2">&quot;$@&quot;</span> -E |
  sed -n <span class="s1">&#39;/^#line [0-9][0-9]* &quot;\([^&quot;]*\)&quot;/ s::echo &quot;`cygpath -u \\&quot;\1\\&quot;`&quot;:p&#39;</span> | sort | uniq &gt; <span class="s2">&quot;$tmpdepfile&quot;</span>
  rm -f <span class="s2">&quot;$depfile&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;$object : \\&quot;</span> &gt; <span class="s2">&quot;$depfile&quot;</span>
  . <span class="s2">&quot;$tmpdepfile&quot;</span> | sed <span class="s1">&#39;s% %\\ %g&#39;</span> | sed -n <span class="s1">&#39;/^\(.*\)$/ s::  \1 \\:p&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;  &quot;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  . <span class="s2">&quot;$tmpdepfile&quot;</span> | sed <span class="s1">&#39;s% %\\ %g&#39;</span> | sed -n <span class="s1">&#39;/^\(.*\)$/ s::\1\::p&#39;</span> &gt;&gt; <span class="s2">&quot;$depfile&quot;</span>
  rm -f <span class="s2">&quot;$tmpdepfile&quot;</span>
  ;;

none<span class="o">)</span>
  <span class="nb">exec</span> <span class="s2">&quot;$@&quot;</span>
  ;;

*<span class="o">)</span>
  <span class="nb">echo</span> <span class="s2">&quot;Unknown depmode $depmode&quot;</span> 1&gt;&amp;2
  <span class="nb">exit </span>1
  ;;
<span class="k">esac</span>

<span class="nb">exit </span>0


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>Local Variables:
mode: shell-script
sh-indentation: 2
eval: (add-hook 'write-file-hooks 'time-stamp)
time-stamp-start: "scriptversion="
time-stamp-format: "%:y-%02m-%02d.%02H"
time-stamp-end: "$"
End:</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
