<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../", thisFile = "node_modules/socket.io/node_modules/policyfile/README.md", defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h2">
        <a href="#lol--wut-">LOL, WUT?</a>
      </div>
      <div class="heading h2">
        <a href="#installation">Installation</a>
      </div>
      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>
      <div class="heading h3">
        <a href="#createserver">createServer</a>
      </div>
      <div class="heading h4">
        <a href="#server.listen">server.listen</a>
      </div>
      <div class="heading h4">
        <a href="#server.add">server.add</a>
      </div>
      <div class="heading h4">
        <a href="#server.add">server.add</a>
      </div>
      <div class="heading h4">
        <a href="#server.close">server.close</a>
      </div>
      <div class="heading h2">
        <a href="#api">API</a>
      </div>
      <div class="heading h2">
        <a href="#examples">Examples</a>
      </div>
      <div class="heading h2">
        <a href="#licence">Licence</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="docs markdown">
<div class="pilwrap" id="lol--wut-">
  <h2>
    <a href="#lol--wut-" class="pilcrow">&#182;</a>
    LOL, WUT?
  </h2>
</div>


<p>It basically allows you to allow or disallow Flash Player sockets from accessing your site.</p>


<div class="pilwrap" id="installation">
  <h2>
    <a href="#installation" class="pilcrow">&#182;</a>
    Installation
  </h2>
</div>



<div class="highlight"><pre><code>npm install policyfile
</code></pre></div>




<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" class="pilcrow">&#182;</a>
    Usage
  </h2>
</div>


<p>The server is based on the regular and know <code>net</code> and <code>http</code> server patterns. So it you can just listen
for all the events that a <code>net</code> based server emits etc. But there is one extra event, the <code>connect_failed</code>
event. This event is triggered when we are unable to listen on the supplied port number.</p>


<div class="pilwrap" id="createserver">
  <h3>
    <a href="#createserver" class="pilcrow">&#182;</a>
    createServer
  </h3>
</div>


<p>Creates a new server instance and accepts 2 optional arguments:</p>

<ul>
<li><code>options</code> <strong>Object</strong> Options to configure the server instance
<ul><li><code>log</code> <strong>Boolean</strong> Enable logging to STDOUT and STDERR (defaults to true)</li></ul></li>
<li><code>origins</code> <strong>Array</strong> An Array of origins that are allowed by the server (defaults to <em>:</em>)</li>
</ul>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
</code></pre></div>




<div class="pilwrap" id="server.listen">
  <h4>
    <a href="#server.listen" class="pilcrow">&#182;</a>
    server.listen
  </h4>
</div>


<p>Start listening on the server and it takes 3 optional arguments</p>

<ul>
<li><code>port</code> <strong>Number</strong> On which port number should we listen? (defaults to 843, which is the first port number the FlashPlayer checks)</li>
<li><code>server</code> <strong>Server</strong> A http server, if we are unable to accept requests or run the server we can also answer the policy requests inline over the supplied HTTP server.</li>
<li><code>callback</code> <strong>Function</strong> A callback function that is called when listening to the server was successful.</li>
</ul>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">1337</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;:3 yay&#39;</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div>



<p>Changing port numbers can be handy if you do not want to run your server as root and have port 843 forward to a non root port number (aka a number above 1024).</p>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>

<span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">){</span><span class="nx">r</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span><span class="nx">r</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">)});</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>

<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">1337</span><span class="p">,</span> <span class="nx">server</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;:3 yay&#39;</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div>



<p>Support for serving inline requests over a existing HTTP connection as the FlashPlayer will first check port 843, but if it's unable to get a response there it will send a policy file request over port 80, which is usually your http server.</p>


<div class="pilwrap" id="server.add">
  <h4>
    <a href="#server.add" class="pilcrow">&#182;</a>
    server.add
  </h4>
</div>


<p>Adds more origins to the policy file you can add as many arguments as you like.</p>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">([</span><span class="s1">&#39;google.com:80&#39;</span><span class="p">]);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;blog.3rd-Eden.com:80&#39;</span><span class="p">,</span> <span class="s1">&#39;blog.3rd-Eden.com:8080&#39;</span><span class="p">);</span> <span class="c1">// now has 3 origins</span>
</code></pre></div>




<div class="pilwrap" id="server.add">
  <h4>
    <a href="#server.add" class="pilcrow">&#182;</a>
    server.add
  </h4>
</div>


<p>Adds more origins to the policy file you can add as many arguments as you like.</p>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">([</span><span class="s1">&#39;blog.3rd-Eden.com:80&#39;</span><span class="p">,</span> <span class="s1">&#39;blog.3rd-Eden.com:8080&#39;</span><span class="p">]);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;blog.3rd-Eden.com:8080&#39;</span><span class="p">);</span> <span class="c1">// only contains the :80 version now</span>
</code></pre></div>




<div class="pilwrap" id="server.close">
  <h4>
    <a href="#server.close" class="pilcrow">&#182;</a>
    server.close
  </h4>
</div>


<p>Shuts down the server</p>


<div class="highlight"><pre><code><span class="kd">var</span> <span class="nx">pf</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;policyfile&#39;</span><span class="p">);</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
<span class="nx">pf</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span> <span class="c1">// OH NVM.</span>
</code></pre></div>




<div class="pilwrap" id="api">
  <h2>
    <a href="#api" class="pilcrow">&#182;</a>
    API
  </h2>
</div>


<p><a href='http://3rd-eden.com/FlashPolicyFileServer/'>http://3rd-eden.com/FlashPolicyFileServer/</a></p>


<div class="pilwrap" id="examples">
  <h2>
    <a href="#examples" class="pilcrow">&#182;</a>
    Examples
  </h2>
</div>


<p>See <a href='https://github.com/3rd-Eden/FlashPolicyFileServer/tree/master/examples'>https://github.com/3rd-Eden/FlashPolicyFileServer/tree/master/examples</a> for examples</p>


<div class="pilwrap" id="licence">
  <h2>
    <a href="#licence" class="pilcrow">&#182;</a>
    Licence
  </h2>
</div>


<p>MIT see LICENSE file in the repository</p></div>
  </div>
</body>
</html>
