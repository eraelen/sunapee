<!DOCTYPE html>
<html>
<head>
  <title>Tokenizer.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../../../doc-style.css" />
  <script src="../../../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../../../", thisFile = "node_modules/socket.io/node_modules/socket.io-client/node_modules/active-x-obfuscator/node_modules/zeparser/Tokenizer.js", defaultSidebar = true;
  </script>
  <script src="../../../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#ifdef-test_suite">ifdef TEST_SUITE</a>
      </div>
      <div class="heading h1">
        <a href="#endif">endif</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>Tokenizer.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nb">window</span> <span class="o">=</span> <span class="p">{</span><span class="nx">Unicode</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./unicodecategories&#39;</span><span class="p">).</span><span class="nx">Unicode</span><span class="p">};</span>
  <span class="nx">exports</span><span class="p">.</span><span class="nx">Tokenizer</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">;</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>!
Tokenizer for JavaScript / ECMAScript 5
(c) Peter van der Zee, qfox.nl</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">inp

</span>
      <span class="dox_type">Object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">Tokenizer</span><span class="p">(</span><span class="nx">inp</span><span class="p">){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">inp</span> <span class="o">=</span> <span class="nx">inp</span><span class="o">||</span><span class="s1">&#39;&#39;</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>replace all other line terminators with \n (leave \r\n in tact though). we should probably remove the shadowInp when finished...
only replace \r if it is not followed by a \n else \r\n would become \n\n causing a double newline where it is just a single</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">shadowInp</span> <span class="o">=</span> <span class="p">(</span><span class="nx">inp</span><span class="o">||</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNormalizeNewlines</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span> <span class="o">=</span> <span class="p">[];</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">wtree</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">btree</span> <span class="o">=</span> <span class="p">[];</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>this.regexWhiteSpace = Tokenizer.regexWhiteSpace;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexLineTerminator</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexLineTerminator</span><span class="p">;</span> <span class="c1">// used in fallback</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexAsciiIdentifier</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexAsciiIdentifier</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">hashAsciiIdentifier</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashAsciiIdentifier</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>this.regexHex = Tokenizer.regexHex;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">hashHex</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashHex</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexUnicodeEscape</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexUnicodeEscape</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexIdentifierStop</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexIdentifierStop</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">hashIdentifierStop</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashIdentifierStop</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>this.regexPunctuators = Tokenizer.regexPunctuators;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexNumber</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNumber</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexNewline</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNewline</span><span class="p">;</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">regexBig</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexBig</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">regexBigAlt</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexBigAlt</span><span class="p">;</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">tokenCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">tokenCountNoWhite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">Unicode</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Unicode</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>if the Parser throws an error. it will set this property to the next match
at the time of the error (which was not what it was expecting at that point) 
and pass on an "error" match. the error should be scooped on the stack and 
this property should be returned, without looking at the input...</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">this</span><span class="p">.</span><span class="nx">errorEscape</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">inp</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">shadowInp</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">pos</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">line</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">column</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">cache</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">errorStack</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  
  <span class="nx">wtree</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// contains whitespace (spaces, comments, newlines)</span>
  <span class="nx">btree</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// does not contain any whitespace tokens.</span>
  
  <span class="nx">regexLineTerminator</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexAsciiIdentifier</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">hashAsciiIdentifier</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">hashHex</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexUnicodeEscape</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexIdentifierStop</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">hashIdentifierStop</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexNumber</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexNewline</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexBig</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">regexBigAlt</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">tokenCount</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  <span class="nx">tokenCountNoWhite</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  
  <span class="nx">Unicode</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>storeCurrentAndFetchNextToken(bool, false, false true) to get just one token</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nx">storeCurrentAndFetchNextToken</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">noRegex</span><span class="p">,</span> <span class="nx">returnValue</span><span class="p">,</span> <span class="nx">stack</span><span class="p">,</span> <span class="nx">_dontStore</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="o">!</span><span class="nx">noRegex</span><span class="p">;</span> <span class="c1">// TOFIX :)</span>
    <span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pos</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">inp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inp</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">shadowInp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">shadowInp</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">matchedNewline</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">do</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_dontStore</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenCount</span><span class="p">;</span>
        <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>did the parent Parser throw up?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">errorEscape</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">errorEscape</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorEscape</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
          <span class="k">return</span> <span class="nx">returnValue</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">_dontStore</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    
      <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&gt;=</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">12</span><span class="cm">/*EOF*/</span><span class="p">};</span>
        <span class="k">break</span><span class="p">;</span> 
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    
      <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">pos</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">chr</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">];</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>

<div class="highlight"><pre><code>                    <span class="mi">1</span> <span class="n">ws</span>                            <span class="mi">2</span> <span class="n">lt</span>                   <span class="mi">3</span> <span class="n">scmt</span> <span class="mi">4</span> <span class="n">mcmt</span> <span class="mi">5</span><span class="o">/</span><span class="mi">6</span> <span class="n">str</span> <span class="mi">7</span> <span class="n">nr</span>     <span class="mi">8</span> <span class="n">rx</span>  <span class="mi">9</span> <span class="n">punc</span>
</code></pre></div>



<p>if (true) {
substring method (I think this is faster..)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">part2</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span><span class="nx">pos</span><span class="o">+</span><span class="mi">4</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">part</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">regexBig</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">part2</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>} else {
// non-substring method (lastIndex)
// this method does not need a substring to apply it
this.regexBigAlt.lastIndex = pos;
var part = this.regexBigAlt.exec(inp);
}</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//this.regexWhiteSpace.test(chr)) { // SP, TAB, VT, FF, NBSP, BOM (, TOFIX: USP)</span>
        <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">9</span><span class="cm">/*WHITE_SPACE*/</span><span class="p">,</span><span class="nx">line</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">,</span><span class="nx">col</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">,</span><span class="nx">isWhite</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
        <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//this.regexLineTerminator.test(chr)) { // LF, CR, LS, PS</span>
        <span class="kd">var</span> <span class="nx">end</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span><span class="o">==</span><span class="s1">&#39;\r&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">end</span><span class="p">;</span> <span class="c1">// support crlf=&gt;lf</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">end</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">10</span><span class="cm">/*LINETERMINATOR*/</span><span class="p">,</span><span class="nx">line</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">,</span><span class="nx">col</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">,</span><span class="nx">isWhite</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
        <span class="nx">pos</span> <span class="o">=</span> <span class="nx">end</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>mark newlines for ASI</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">matchedNewline</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">returnValue</span><span class="p">.</span><span class="nx">hasNewline</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//chr == &#39;/&#39; &amp;&amp; inp[pos+1] == &#39;/&#39;) {</span>
        <span class="nx">pos</span> <span class="o">=</span> <span class="nx">shadowInp</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="nx">pos</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">pos</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">7</span><span class="cm">/*COMMENT_SINGLE*/</span><span class="p">,</span><span class="nx">line</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">,</span><span class="nx">col</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">,</span><span class="nx">isComment</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isWhite</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">stop</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//chr == &#39;/&#39; &amp;&amp; inp[pos+1] == &#39;*&#39;) {</span>
        <span class="kd">var</span> <span class="nx">newpos</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;*/&#39;</span><span class="p">,</span><span class="nx">pos</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">newpos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">newpos</span> <span class="o">=</span> <span class="nx">shadowInp</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span> <span class="nx">pos</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">newpos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">pos</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
          <span class="k">else</span> <span class="nx">pos</span> <span class="o">=</span> <span class="nx">newpos</span><span class="p">;</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">line</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">,</span><span class="nx">col</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">,</span><span class="nx">isComment</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isWhite</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedMultiLineComment</span><span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">pos</span> <span class="o">=</span> <span class="nx">newpos</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">8</span><span class="cm">/*COMMENT_MULTI*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">line</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">,</span><span class="nx">col</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">column</span><span class="p">,</span><span class="nx">isComment</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isWhite</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>multi line comments are also reason for asi, but only if they contain at least one newline (use shadow input, because all line terminators would be valid...)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="kd">var</span> <span class="nx">shadowValue</span> <span class="o">=</span> <span class="nx">shadowInp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">hasNewline</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">shadowValue</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="p">{</span>
            <span class="o">++</span><span class="nx">hasNewline</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">hasNewline</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">matchedNewline</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">returnValue</span><span class="p">.</span><span class="nx">hasNewline</span> <span class="o">=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">+=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">stop</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//chr == &quot;&#39;&quot;) {</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>old method
console.log("old method");</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        
        <span class="kd">var</span> <span class="nx">hasNewline</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">do</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>process escaped characters</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="o">++</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">shadowInp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">hasNewline</span><span class="p">;</span>
            <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">regexLineTerminator</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedDoubleStringNewline</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">)</span> <span class="p">{}</span> <span class="c1">// error</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedDoubleStringOther</span><span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">5</span><span class="cm">/*STRING_SINGLE*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">hasNewline</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span><span class="p">.</span><span class="nx">hasNewline</span> <span class="o">=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">+=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>       
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//chr == &#39;&quot;&#39;) {</span>
        <span class="kd">var</span> <span class="nx">hasNewline</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>TODO: something like this: var regexmatch = /([^\']|$)+/.match();</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">do</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>process escaped chars</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="o">++</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">shadowInp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">hasNewline</span><span class="p">;</span>
            <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">regexLineTerminator</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedSingleStringNewline</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">)</span> <span class="p">{}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">pos</span><span class="p">),</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedSingleStringOther</span><span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">6</span><span class="cm">/*STRING_DOUBLE*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isString</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">hasNewline</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span><span class="p">.</span><span class="nx">hasNewline</span> <span class="o">=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">+=</span> <span class="nx">hasNewline</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">column</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">part</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="p">{</span> <span class="c1">//(chr &gt;= &#39;0&#39; &amp;&amp; chr &lt;= &#39;9&#39;) || (chr == &#39;.&#39; &amp;&amp; inp[pos+1] &gt;= &#39;0&#39; &amp;&amp; inp[pos+1] &lt;= &#39;9&#39;)) {</span>
        <span class="kd">var</span> <span class="nx">nextPart</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">pos</span><span class="o">+</span><span class="mi">30</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">nextPart</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">regexNumber</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">{</span> <span class="c1">// decimal</span>
          <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
          <span class="kd">var</span> <span class="nx">parsingOctal</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;e&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;E&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">parsingOctal</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isOctal</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">IllegalOctalEscape</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">value</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">start</span><span class="o">+</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">4</span><span class="cm">/*NUMERIC_DEC*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">value</span><span class="p">};</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span> <span class="c1">// hex</span>
          <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">start</span><span class="o">+</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">3</span><span class="cm">/*NUMERIC_HEX*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">value</span><span class="p">};</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="s1">&#39;unexpected parser errror... regex fail :(&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">pos</span> <span class="o">+=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>old method of parsing numbers. only used for extremely long number literals (300+ chars).
this method does not require substringing... just memory :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="kd">var</span> <span class="nx">tmpReturnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">oldNumberParser</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">chr</span><span class="p">,</span> <span class="nx">inp</span><span class="p">,</span> <span class="nx">returnValue</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">Tokenizer</span><span class="p">);</span>
          <span class="nx">pos</span> <span class="o">=</span> <span class="nx">tmpReturnValue</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">tmpReturnValue</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>} else if (regex &amp;&amp; part[8]) { //chr == '/') { // regex cannot start with    (would be multiline comment, and not make sense anyways). but if it was /* then an earlier if would have eated it. so we only check for /
var twinfo = []; // matching {[( info
var found = false;
var parens = [];
var nonLethalError = null;
while (++pos &lt; inp.length) {
chr = shadowInp[pos];
// parse RegularExpressionChar
if (chr == '\n') {
returnValue = {start:start,stop:pos,name:14/*error  ,tokenError:true,errorHasContent:true,error:Tokenizer.Error.UnterminatedRegularExpressionNewline};</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span> <span class="c1">// fail</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">found</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="o">||</span> <span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span> <span class="o">||</span> <span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">NothingToRepeat</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;^&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span>
              <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> 
              <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;|&#39;</span> <span class="o">&amp;&amp;</span> 
              <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;(&#39;</span> <span class="o">&amp;&amp;</span>
              <span class="o">!</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;!&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">))</span>
            <span class="p">)</span> <span class="p">{</span>
              <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">StartOfMatchShouldBeAtStart</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;|&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span> <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">DollarShouldBeEnd</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">MissingOpeningCurly</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// it&#39;s a &quot;character&quot; (can be group or class), something to match</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>match parenthesis</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">parens</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">parens</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">RegexNoOpenGroups</span><span class="p">};</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">twin</span> <span class="o">=</span> <span class="nx">parens</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">twin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">now</span><span class="p">]</span> <span class="o">=</span> <span class="nx">twin</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>first process character class</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="kd">var</span> <span class="nx">before</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">;</span>
              <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">shadowInp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;\n&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>only newline is not allowed in class range
anything else can be escaped, most of it does not have to be escaped...</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">shadowInp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                  <span class="k">else</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span> <span class="c1">// skip next char. (mainly prohibits ] to be picked up as closing the group...)</span>
                <span class="p">}</span>
              <span class="p">}</span> 
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">ClosingClassRangeNotFound</span><span class="p">};</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">after</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">before</span><span class="p">]</span> <span class="o">=</span> <span class="nx">after</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">after</span><span class="p">]</span> <span class="o">=</span> <span class="nx">before</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">shadowInp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>is ok anywhere in the regex (match next char literally, regardless of its otherwise special meaning)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
              <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
            <span class="p">}</span>
            

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>now process repeaters (+, ? and *)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>non-collecting group (?:...) and positive (?=...) or negative (?!...) lookahead</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;!&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">pos</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>matching "char"</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span> <span class="c1">// non-greedy match</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;{&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">pos</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
              <span class="kd">var</span> <span class="nx">before</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>quantifier:
- {n}
- {n,}
- {n,m}</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/[0-9]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">QuantifierRequiresNumber</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="sr">/[0-9]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]));</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
                <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="sr">/[0-9]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">nonLethalError</span> <span class="o">=</span> <span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">QuantifierRequiresClosingCurly</span><span class="p">;</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">after</span> <span class="o">=</span> <span class="nx">pos</span><span class="o">-</span><span class="nx">start</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">before</span><span class="p">]</span> <span class="o">=</span> <span class="nx">after</span><span class="p">;</span>
                <span class="nx">twinfo</span><span class="p">[</span><span class="nx">after</span><span class="p">]</span> <span class="o">=</span> <span class="nx">before</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span> <span class="c1">// non-greedy match</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>if found=false, fail right now. otherwise try to parse an identifiername (that's all RegularExpressionFlags is..., but it's constructed in a stupid fashion)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">found</span> <span class="o">||</span> <span class="nx">returnValue</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">returnValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">UnterminatedRegularExpressionOther</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>this is the identifier scanner, for now</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">do</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">hashAsciiIdentifier</span><span class="p">[</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]]);</span> <span class="cm">/*this.regexAsciiIdentifier.test(inp[pos])*/</span> 
  
          <span class="k">if</span> <span class="p">(</span><span class="nx">parens</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>nope, this is still an error, there was at least one paren that did not have a matching twin</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">parens</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">RegexOpenGroup</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nonLethalError</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">errorHasContent</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">nonLethalError</span><span class="p">};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="cm">/*REG_EX*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
          <span class="p">}</span>       
        <span class="p">}</span>
        <span class="nx">returnValue</span><span class="p">.</span><span class="nx">twinfo</span> <span class="o">=</span> <span class="nx">twinfo</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>note: operators need to be ordered from longest to smallest. regex will take care of the rest.
no need to worry about div vs regex. if looking for regex, earlier if will have eaten it
var result = this.regexPunctuators.exec(inp.substring(pos,pos+4));</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<p>note: due to the regex, the single forward slash might be caught by an earlier part of the regex. so check for that.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">part</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">||</span> <span class="nx">part</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>result = result[1];</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="o">+=</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">11</span><span class="cm">/*PUNCTUATOR*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">result</span><span class="p">};</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">found</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>identifiers cannot start with a number. but if the leading string would be a number, another if would have eaten it already for numeric literal :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">];</span>
  
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hashAsciiIdentifier</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span> <span class="c1">//if (this.regexAsciiIdentifier.test(c)) ++pos;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">regexUnicodeEscape</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span><span class="nx">pos</span><span class="o">+</span><span class="mi">6</span><span class="p">)))</span> <span class="nx">pos</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">// this is like a \uxxxx</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>ok, now test unicode ranges...
basically this hardly ever happens so there's little risk of this hitting performance
however, if you do happen to have used them, it's not a problem. the parser will support it :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">Unicode</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// the unicode is optional.</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>these chars may not be part of identifier. i want to try to prevent running the unicode regexes here...</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
              <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hashIdentifierStop</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="cm">/*this.regexIdentifierStop.test(c)*/</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>for most scripts, the code wont reach here. which is good, because this is going to be relatively slow :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
              <span class="kd">var</span> <span class="nx">Unicode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">Unicode</span><span class="p">;</span> <span class="c1">// cache</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<p>these may all occur in an identifier... (pure a specification compliance thing :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                  <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Lu</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Ll</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Lt</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Lm</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> 
                  <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Lo</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Nl</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Mn</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Mc</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span>
                  <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Nd</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">Pc</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Unicode</span><span class="p">.</span><span class="nx">sp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
              <span class="p">))</span> <span class="k">break</span><span class="p">;</span> <span class="c1">// end of match.</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40">&#182;</a>
</div>
<p>passed, next char</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
              <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">break</span><span class="p">;</span> <span class="c1">// end of match.</span>
      
            <span class="nx">found</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>
    
          <span class="k">if</span> <span class="p">(</span><span class="nx">found</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">2</span><span class="cm">/*IDENTIFIER*/</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="nx">pos</span><span class="p">)};</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;null&#39;</span> <span class="o">||</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span> <span class="o">||</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">isPrimitive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;`&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">BacktickNotSupported</span><span class="p">};</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;\\&#39;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">InvalidUnicodeEscape</span><span class="p">};</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">InvalidBackslash</span><span class="p">};</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
              <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">Unknown</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">c</span><span class="p">};</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41">&#182;</a>
</div>
<p>try to skip this char. it's not going anywhere.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="p">}</span>
            <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>note that ASI's are slipstreamed in here from the parser since the tokenizer cant determine that
if this part ever changes, make sure you change that too :)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">returnValue</span><span class="p">.</span><span class="nx">tokposw</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wtree</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">wtree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">returnValue</span><span class="p">.</span><span class="nx">isWhite</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span><span class="p">.</span><span class="nx">tokposb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">btree</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">btree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="p">}</span> 
      <span class="p">}</span>
      
      
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">stack</span> <span class="o">&amp;&amp;</span> <span class="nx">returnValue</span> <span class="o">&amp;&amp;</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">isWhite</span><span class="p">);</span> <span class="c1">// WHITE_SPACE LINETERMINATOR COMMENT_SINGLE COMMENT_MULTI</span>
    <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenCountNoWhite</span><span class="p">;</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pos</span><span class="p">;</span>
  
    <span class="k">if</span> <span class="p">(</span><span class="nx">matchedNewline</span><span class="p">)</span> <span class="nx">returnValue</span><span class="p">.</span><span class="nx">newline</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">returnValue</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">addTokenToStreamBefore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">match</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">wtree</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wtree</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">btree</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">btree</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="mi">12</span><span class="cm">/*asi*/</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">token</span><span class="p">.</span><span class="nx">tokposw</span> <span class="o">=</span> <span class="nx">wtree</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="nx">wtree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
      <span class="nx">token</span><span class="p">.</span><span class="nx">tokposb</span> <span class="o">=</span> <span class="nx">btree</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="nx">btree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">token</span><span class="p">.</span><span class="nx">tokposw</span> <span class="o">=</span> <span class="nx">match</span><span class="p">.</span><span class="nx">tokposw</span><span class="p">;</span>
      <span class="nx">wtree</span><span class="p">[</span><span class="nx">token</span><span class="p">.</span><span class="nx">tokposw</span><span class="p">]</span> <span class="o">=</span> <span class="nx">token</span><span class="p">;</span>
      <span class="nx">match</span><span class="p">.</span><span class="nx">tokposw</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="nx">wtree</span><span class="p">[</span><span class="nx">match</span><span class="p">.</span><span class="nx">tokposw</span><span class="p">]</span> <span class="o">=</span> <span class="nx">match</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">.</span><span class="nx">tokposb</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">token</span><span class="p">.</span><span class="nx">tokposb</span> <span class="o">=</span> <span class="nx">match</span><span class="p">.</span><span class="nx">tokposb</span><span class="p">;</span>
        <span class="nx">btree</span><span class="p">[</span><span class="nx">token</span><span class="p">.</span><span class="nx">tokposb</span><span class="p">]</span> <span class="o">=</span> <span class="nx">token</span><span class="p">;</span>
        <span class="nx">match</span><span class="p">.</span><span class="nx">tokposb</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">btree</span><span class="p">[</span><span class="nx">match</span><span class="p">.</span><span class="nx">tokposb</span><span class="p">]</span> <span class="o">=</span> <span class="nx">match</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">oldNumberParser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">chr</span><span class="p">,</span> <span class="nx">inp</span><span class="p">,</span> <span class="nx">returnValue</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">Tokenizer</span><span class="p">){</span>
    <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>either: 0x 0X 0 .3</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">))</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<p>parsing hex</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">hashHex</span><span class="p">[</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]]);</span> <span class="c1">// this.regexHex.test(inp[pos]));</span>
      <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">3</span><span class="cm">/*NUMERIC_HEX*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">parsingOctal</span> <span class="o">=</span> <span class="nx">chr</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>parsing dec</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">chr</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// integer part</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
      <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>decimal part</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>exponent part</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;e&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inp</span><span class="p">[</span><span class="o">++</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="o">||</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">expPosBak</span> <span class="o">=</span> <span class="nx">pos</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">inp</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inp</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s1">&#39;9&#39;</span><span class="p">)</span> <span class="o">++</span><span class="nx">pos</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">expPosBak</span> <span class="o">==</span> <span class="nx">pos</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">NumberExponentRequiresDigits</span><span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="mi">14</span><span class="cm">/*error*/</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">parsingOctal</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">14</span><span class="cm">/*error*/</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isOctal</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">tokenError</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span><span class="p">.</span><span class="nx">IllegalOctalEscape</span><span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">returnValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">start</span><span class="o">:</span><span class="nx">start</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="nx">pos</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="mi">4</span><span class="cm">/*NUMERIC_DEC*/</span><span class="p">,</span><span class="nx">isPrimitive</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">isNumber</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">returnValue</span><span class="p">];</span>
  <span class="p">},</span>
  <span class="nx">tokens</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arrx</span><span class="p">){</span>
    <span class="nx">arrx</span> <span class="o">=</span> <span class="nx">arrx</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">last</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">while</span> <span class="p">((</span><span class="nx">last</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">storeCurrentAndFetchNextToken</span><span class="p">(</span><span class="o">!</span><span class="nx">arrx</span><span class="p">[</span><span class="nx">n</span><span class="o">++</span><span class="p">],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nx">last</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="mi">12</span><span class="cm">/*EOF*/</span><span class="p">)</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">last</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">stack</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">fixValues</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">wtree</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">t</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="nx">t</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">start</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">stop</span><span class="p">);</span>
    <span class="p">},</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ifdef-test_suite">
  <h1>
    <a href="#ifdef-test_suite" class="pilcrow">&#182;</a>
    ifdef TEST_SUITE
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span><span class="s1">&#39;\\n&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\t/g</span><span class="p">,</span><span class="s1">&#39;\\t&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span><span class="s1">&#39;&amp;amp;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span><span class="s1">&#39;&amp;lt;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\uFFFF/g</span><span class="p">,</span> <span class="s1">&#39;\\uFFFF&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>replace whitespace as is...</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">ord</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">ord</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="nx">ord</span> <span class="o">=</span> <span class="s1">&#39;000&#39;</span><span class="o">+</span><span class="nx">ord</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="nx">ord</span> <span class="o">=</span> <span class="s1">&#39;00&#39;</span><span class="o">+</span><span class="nx">ord</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="nx">ord</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="nx">ord</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="s1">&#39;\\u&#39;</span><span class="o">+</span><span class="nx">ord</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">testSuite</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;pre&#39;</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">out</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">debug</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
    <span class="nx">f</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">};</span>

  <span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;Running test suite...&quot;</span><span class="p">,</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="s2">&quot;tests&quot;</span><span class="p">);</span>
  <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="o">+</span><span class="k">new</span> <span class="nb">Date</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">ok</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">fail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">result</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">test</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputLen</span> <span class="o">=</span> <span class="nx">test</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">regexHints</span> <span class="o">=</span> <span class="nx">test</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">?</span> <span class="nx">test</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// if flags, then len=4</span>
    <span class="kd">var</span> <span class="nx">desc</span> <span class="o">=</span> <span class="nx">test</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">||</span> <span class="nx">test</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tokenizer</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">tokens</span><span class="p">(</span><span class="nx">regexHints</span><span class="p">);</span> <span class="c1">// regexHints can be null, that&#39;s ok</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="nx">outputLen</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39;&lt;span class=&quot;green&quot;&gt;Test &#39;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="s1">&#39; ok:&lt;/span&gt;&#39;</span><span class="p">,</span><span class="nx">desc</span><span class="p">);</span>
      <span class="o">++</span><span class="nx">ok</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39;&lt;b class=&quot;red&quot;&gt;Test failed:&lt;/span&gt;&#39;</span><span class="p">,</span><span class="nx">desc</span><span class="p">,</span><span class="s1">&#39;(found&#39;</span><span class="p">,</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="s1">&#39;expected&#39;</span><span class="p">,</span><span class="nx">outputLen</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">),</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">desc</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
      <span class="o">++</span><span class="nx">fail</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">+</span><span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="p">);</span>
    <span class="nx">debug</span><span class="p">(</span><span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;Tokenizer test suite finished (&quot;</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="k">new</span> <span class="nb">Date</span> <span class="o">-</span> <span class="nx">start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; ms). ok:&#39;</span><span class="o">+</span><span class="nx">ok</span><span class="o">+</span><span class="s1">&#39;, fail:&#39;</span><span class="o">+</span><span class="nx">fail</span><span class="p">);</span>
<span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="endif">
  <h1>
    <a href="#endif" class="pilcrow">&#182;</a>
    endif
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexWhiteSpace</span> <span class="o">=</span> <span class="sr">/[ \t\u000B\u000C\u00A0\uFFFF]/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexLineTerminator</span> <span class="o">=</span> <span class="sr">/[\u000A\u000D\u2028\u2029]/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexAsciiIdentifier</span> <span class="o">=</span> <span class="sr">/[a-zA-Z0-9\$_]/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashAsciiIdentifier</span> <span class="o">=</span> <span class="p">{</span><span class="nx">_</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">$</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">c</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">d</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">e</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">f</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">g</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">h</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">i</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">l</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">m</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">n</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">o</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">p</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">q</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">r</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">s</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">t</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">u</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">v</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">w</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">y</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">z</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">A</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">B</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">D</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">E</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">F</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">G</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">H</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">I</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">J</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">K</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">L</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">M</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">N</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">O</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">P</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">Q</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">R</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">S</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">T</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">U</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">V</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">W</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">X</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">Y</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">Z</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span><span class="p">};</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexHex</span> <span class="o">=</span> <span class="sr">/[0-9A-Fa-f]/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashHex</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">c</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">d</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">e</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">f</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">A</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">B</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">C</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">D</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">E</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">F</span><span class="o">:</span><span class="mi">1</span><span class="p">};</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexUnicodeEscape</span> <span class="o">=</span> <span class="sr">/u[0-9A-Fa-f]{4}/</span><span class="p">;</span> <span class="c1">// the \ is already checked at usage...</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexIdentifierStop</span> <span class="o">=</span> <span class="sr">/[\&gt;\=\!\|\&lt;\+\-\&amp;\*\%\^\/\{\}\(\)\[\]\.\;\,\~\?\:\ \t\n\\\&#39;\&quot;]/</span><span class="p">;</span> 
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">hashIdentifierStop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;&gt;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;!&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&lt;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&amp;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;^&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;{&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;[&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;]&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;~&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;\\&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;\&#39;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;\t&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;\n&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">};</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNewline</span> <span class="o">=</span> <span class="sr">/\n/g</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>Tokenizer.regexPunctuators = /^(>>>=|===|!==|>>>|&lt;&lt;=|>>=|&lt;=|>=|==|!=|++|--|&lt;&lt;|>>|\&amp;\&amp;|\|\||+=|-=|*=|%=|\&amp;=|\|=|\^=|\/=|{|}|(|)|[|]|.|;|,|&lt;|>|+|-|*|%|\||\&amp;|\||\^|!|~|\?|:|=|\/)/;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">Unidocde</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Unicode</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNumber</span> <span class="o">=</span> <span class="sr">/^(?:(0[xX][0-9A-Fa-f]+)|((?:(?:(?:(?:[0-9]+)(?:\.[0-9]*)?))|(?:\.[0-9]+))(?:[eE][-+]?[0-9]{1,})?))/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexNormalizeNewlines</span> <span class="o">=</span> <span class="sr">/(\u000D[^\u000A])|[\u2028\u2029]/</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>

<div class="highlight"><pre><code>                    <span class="mi">1</span> <span class="n">ws</span>                            <span class="mi">2</span> <span class="n">lt</span>                   <span class="mi">3</span> <span class="n">scmt</span> <span class="mi">4</span> <span class="n">mcmt</span> <span class="mi">5</span><span class="o">/</span><span class="mi">6</span> <span class="n">str</span> <span class="mi">7</span> <span class="n">nr</span>     <span class="mi">8</span> <span class="n">rx</span>  <span class="mi">9</span> <span class="n">punc</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexBig</span> <span class="o">=</span> <span class="sr">/^([ \t\u000B\u000C\u00A0\uFFFF])?([\u000A\u000D\u2028\u2029])?(\/\/)?(\/\*)?(&#39;)?(&quot;)?(\.?[0-9])?(?:(\/)[^=])?(&gt;&gt;&gt;=|===|!==|&gt;&gt;&gt;|&lt;&lt;=|&gt;&gt;=|&lt;=|&gt;=|==|!=|\+\+|--|&lt;&lt;|&gt;&gt;|\&amp;\&amp;|\|\||\+=|-=|\*=|%=|\&amp;=|\|=|\^=|\/=|\{|\}|\(|\)|\[|\]|\.|;|,|&lt;|&gt;|\+|-|\*|%|\||\&amp;|\||\^|!|~|\?|:|=|\/)?/</span><span class="p">;</span>
<span class="nx">Tokenizer</span><span class="p">.</span><span class="nx">regexBigAlt</span> <span class="o">=</span> <span class="sr">/([ \t\u000B\u000C\u00A0\uFFFF])?([\u000A\u000D\u2028\u2029])?(\/\/)?(\/\*)?(&#39;)?(&quot;)?(\.?[0-9])?(?:(\/)[^=])?(&gt;&gt;&gt;=|===|!==|&gt;&gt;&gt;|&lt;&lt;=|&gt;&gt;=|&lt;=|&gt;=|==|!=|\+\+|--|&lt;&lt;|&gt;&gt;|\&amp;\&amp;|\|\||\+=|-=|\*=|%=|\&amp;=|\|=|\^=|\/=|\{|\}|\(|\)|\[|\]|\.|;|,|&lt;|&gt;|\+|-|\*|%|\||\&amp;|\||\^|!|~|\?|:|=|\/)?/g</span><span class="p">;</span>

<span class="nx">Tokenizer</span><span class="p">.</span><span class="nb">Error</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">UnterminatedSingleStringNewline</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Newlines are not allowed in string literals&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedSingleStringOther</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unterminated single string&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedDoubleStringNewline</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Newlines are not allowed in string literals&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedDoubleStringOther</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unterminated double string&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedRegularExpressionNewline</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Newlines are not allowed in regular expressions&#39;</span><span class="p">},</span>
  <span class="nx">NothingToRepeat</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Used a repeat character (*?+) in a regex without something prior to it to match&#39;</span><span class="p">},</span>
  <span class="nx">ClosingClassRangeNotFound</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;Unable to find ] for class range&#39;</span><span class="p">},</span>
  <span class="nx">RegexOpenGroup</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;Open group did not find closing parenthesis&#39;</span><span class="p">},</span>
  <span class="nx">RegexNoOpenGroups</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;Closing parenthesis found but no group open&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedRegularExpressionOther</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unterminated regular expression&#39;</span><span class="p">},</span>
  <span class="nx">UnterminatedMultiLineComment</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unterminated multi line comment&#39;</span><span class="p">},</span>
  <span class="nx">UnexpectedIdentifier</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unexpected identifier&#39;</span><span class="p">},</span>
  <span class="nx">IllegalOctalEscape</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Octal escapes are not valid&#39;</span><span class="p">},</span>
  <span class="nx">Unknown</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Unknown input&#39;</span><span class="p">},</span> <span class="c1">// if this happens, my parser is bad :(</span>
  <span class="nx">NumberExponentRequiresDigits</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Numbers with exponents require at least one digit after the `e`&#39;</span><span class="p">},</span>
  <span class="nx">BacktickNotSupported</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;The backtick is not used in js, maybe you copy/pasted from a fancy site/doc?&#39;</span><span class="p">},</span>
  <span class="nx">InvalidUnicodeEscape</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Encountered an invalid unicode escape, must be followed by exactly four hex numbers&#39;</span><span class="p">},</span>
  <span class="nx">InvalidBackslash</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Encountered a backslash where it not allowed&#39;</span><span class="p">},</span>
  <span class="nx">StartOfMatchShouldBeAtStart</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;The ^ signifies the start of match but was not found at a start&#39;</span><span class="p">},</span>
  <span class="nx">DollarShouldBeEnd</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;The $ signifies the stop of match but was not found at a stop&#39;</span><span class="p">},</span>
  <span class="nx">QuantifierRequiresNumber</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Quantifier curly requires at least one digit before the comma&#39;</span><span class="p">},</span>
  <span class="nx">QuantifierRequiresClosingCurly</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Quantifier curly requires to be closed&#39;</span><span class="p">},</span>
  <span class="nx">MissingOpeningCurly</span><span class="o">:</span> <span class="p">{</span><span class="nx">msg</span><span class="o">:</span><span class="s1">&#39;Encountered closing quantifier curly without seeing an opening curly&#39;</span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
