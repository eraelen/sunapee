<!DOCTYPE html>
<html>
<head>
  <title>Crypto.as</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../../../../../../doc-style.css" />
  <script src="../../../../../../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../../../../../../", thisFile = "node_modules/socket.io/node_modules/socket.io-client/lib/vendor/web-socket-js/flash-src/com/hurlant/crypto/Crypto.as", defaultSidebar = true;
  </script>
  <script src="../../../../../../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>Crypto.as</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<p>*
* Crypto
* 
* An abstraction layer to instanciate our crypto algorithms
* Copyright (c) 2007 Henri Torgemane
* 
* See LICENSE.txt for full license information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span>
<span class="p">{</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">HMAC</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">MAC</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">IHash</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">MD2</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">MD5</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA1</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA224</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA256</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">prng</span><span class="p">.</span><span class="nx">ARC4</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa</span><span class="p">.</span><span class="nx">RSAKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">AESKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">BlowFishKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">CBCMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">CFB8Mode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">CFBMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">CTRMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">DESKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">ECBMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">ICipher</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">IMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">IPad</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">ISymmetricKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">IVMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">NullPad</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">OFBMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">PKCS5</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">SimpleIVMode</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">TripleDESKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span><span class="p">.</span><span class="nx">XTeaKey</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Base64</span><span class="o">;</span>
  
  <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nb">ByteArray</span><span class="o">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>*
* A class to make it easy to use the rest of the framework.
* As a side-effect, using this class will cause most of the framework
* to be linked into your application, which is not always what you want.
* 
* If you want to optimize your download size, don't use this class.
* (But feel free to read it to get ideas on how to get the algorithm you want.)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nx">Crypto</span>
  <span class="p">{</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">b64</span><span class="o">:</span><span class="nx">Base64</span><span class="o">;</span> <span class="c1">// we don&#39;t use it, but we want the swc to include it, so cheap trick.</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">Crypto</span><span class="p">(){</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>*
* Things that should work, among others:
*  "aes"
*  "aes-128-ecb"
*  "aes-128-cbc"
*  "aes-128-cfb"
*  "aes-128-cfb8"
*  "aes-128-ofb"
*  "aes-192-cfb"
*  "aes-256-ofb"
*  "blowfish-cbc"
*  "des-ecb"
*  "xtea"
*  "xtea-ecb"
*  "xtea-cbc"
*  "xtea-cfb"
*  "xtea-cfb8"
*  "xtea-ofb"
*  "rc4"
*  "simple-aes-cbc"</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getCipher</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="o">,</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">pad</span><span class="o">:</span><span class="nx">IPad</span><span class="o">=</span><span class="kc">null</span><span class="p">)</span><span class="o">:</span><span class="nx">ICipher</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>split name into an array.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
      <span class="k">switch</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>*
* "simple" is a special case. It means:
* "If using an IV mode, prepend the IV to the ciphertext"</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">case</span> <span class="s2">&quot;simple&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="nx">name</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
          <span class="k">var</span> <span class="nx">cipher</span><span class="o">:</span><span class="nx">ICipher</span> <span class="o">=</span> <span class="nx">getCipher</span><span class="p">(</span><span class="nx">name</span><span class="o">,</span> <span class="nx">key</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">cipher</span> <span class="nx">is</span> <span class="nx">IVMode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">SimpleIVMode</span><span class="p">(</span><span class="nx">cipher</span> <span class="nx">as</span> <span class="nx">IVMode</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">cipher</span><span class="o">;</span>
          <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>*
* we support both "aes-128" and "aes128"
* Technically, you could use "aes192-128", but you'd
* only be hurting yourself.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">case</span> <span class="s2">&quot;aes&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;aes128&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;aes192&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;aes256&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">length</span><span class="o">*</span><span class="mi">8</span><span class="o">==</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>support for "aes-128-..." and such.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span> <span class="k">new</span> <span class="nx">AESKey</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>
        <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;bf&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;blowfish&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span> <span class="k">new</span> <span class="nx">BlowFishKey</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>*
* des-ede and des-ede3 are both equivalent to des3.
* the choice between 2tdes and 3tdes is made based
* on the length of the key provided.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">case</span> <span class="s2">&quot;des&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;ede&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;ede3&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span> <span class="k">new</span> <span class="nx">DESKey</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">keys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;ecb&quot;</span><span class="p">);</span> <span class="c1">// default mode for 2tdes and 3tdes with openssl enc</span>
          <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>fall-through to triple des</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">case</span> <span class="s2">&quot;3des&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;des3&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span> <span class="k">new</span> <span class="nx">TripleDESKey</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;xtea&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span> <span class="k">new</span> <span class="nx">XTeaKey</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">,</span> <span class="nx">pad</span><span class="p">);</span>
        <span class="k">break</span><span class="o">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>*
* Technically, you could say "rc4-128" or whatever,
* but really, the length of the key is what counts here.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">case</span> <span class="s2">&quot;rc4&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">ARC4</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="k">break</span><span class="o">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>*
* Returns the size of a key for a given cipher identifier.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getKeySize</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nb">uint</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
      <span class="k">switch</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;simple&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="nx">getKeySize</span><span class="p">(</span><span class="nx">keys</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">));</span>
        <span class="k">case</span> <span class="s2">&quot;aes128&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">16</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;aes192&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">24</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;aes256&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">32</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;aes&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">return</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">8</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;bf&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;blowfish&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">16</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;des&quot;</span><span class="o">:</span>
          <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="k">switch</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s2">&quot;ede&quot;</span><span class="o">:</span>
              <span class="k">return</span> <span class="mi">16</span><span class="o">;</span>
            <span class="k">case</span> <span class="s2">&quot;ede3&quot;</span><span class="o">:</span>
              <span class="k">return</span> <span class="mi">24</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
              <span class="k">return</span> <span class="mi">8</span><span class="o">;</span>
          <span class="p">}</span>
        <span class="k">case</span> <span class="s2">&quot;3des&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s2">&quot;des3&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">24</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;xtea&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="mi">8</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;rc4&quot;</span><span class="o">:</span>
          <span class="k">if</span> <span class="p">(</span><span class="nf">parseInt</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">8</span><span class="o">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="mi">16</span><span class="o">;</span> <span class="c1">// why not.</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">// unknown;</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getMode</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="o">,</span> <span class="nx">alg</span><span class="o">:</span><span class="nx">ISymmetricKey</span><span class="o">,</span> <span class="nx">padding</span><span class="o">:</span><span class="nx">IPad</span><span class="o">=</span><span class="kc">null</span><span class="p">)</span><span class="o">:</span><span class="nx">IMode</span> <span class="p">{</span>
      <span class="k">switch</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;ecb&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">ECBMode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;cfb&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">CFBMode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;cfb8&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">CFB8Mode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;ofb&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">OFBMode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;ctr&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">CTRMode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;cbc&quot;</span><span class="o">:</span>
        <span class="k">default</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">CBCMode</span><span class="p">(</span><span class="nx">alg</span><span class="o">,</span> <span class="nx">padding</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>*
* Things that should work:
* "md5"
* "sha"
* "sha1"
* "sha224"
* "sha256"</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getHash</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nx">IHash</span> <span class="p">{</span>
      <span class="k">switch</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;md2&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">MD2</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;md5&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">MD5</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;sha&quot;</span><span class="o">:</span> <span class="c1">// let&#39;s hope you didn&#39;t mean sha-0</span>
        <span class="k">case</span> <span class="s2">&quot;sha1&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">SHA1</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;sha224&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">SHA224</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;sha256&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">SHA256</span><span class="o">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>*
* Things that should work:
* "sha1"
* "md5-64"
* "hmac-md5-96"
* "hmac-sha1-128"
* "hmac-sha256-192"
* etc.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getHMAC</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nx">HMAC</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;hmac&quot;</span><span class="p">)</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
      <span class="k">var</span> <span class="nx">bits</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">bits</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="nx">getHash</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">,</span> <span class="nx">bits</span><span class="p">);</span>
    <span class="p">}</span>
    

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getMAC</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nx">MAC</span> <span class="p">{</span>
      
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;mac&quot;</span><span class="p">)</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
      <span class="k">var</span> <span class="nx">bits</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">bits</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MAC</span><span class="p">(</span><span class="nx">getHash</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">,</span> <span class="nx">bits</span><span class="p">);</span>
    <span class="p">}</span>
        
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getPad</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nx">IPad</span> <span class="p">{</span>
      <span class="k">switch</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;null&quot;</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">NullPad</span><span class="o">;</span>
        <span class="k">case</span> <span class="s2">&quot;pkcs5&quot;</span><span class="o">:</span>
        <span class="k">default</span><span class="o">:</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">PKCS5</span><span class="o">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<ul>
<li>mostly useless.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getRSA</span><span class="p">(</span><span class="nx">E</span><span class="o">:</span><span class="nb">String</span><span class="o">,</span> <span class="nx">M</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:</span><span class="nx">RSAKey</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">RSAKey</span><span class="p">.</span><span class="nx">parsePublicKey</span><span class="p">(</span><span class="nx">M</span><span class="o">,</span><span class="nx">E</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
