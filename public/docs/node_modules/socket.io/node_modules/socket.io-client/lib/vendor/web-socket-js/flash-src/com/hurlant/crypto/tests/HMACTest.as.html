<!DOCTYPE html>
<html>
<head>
  <title>HMACTest.as</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../../../../../../../doc-style.css" />
  <script src="../../../../../../../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../../../../../../../", thisFile = "node_modules/socket.io/node_modules/socket.io-client/lib/vendor/web-socket-js/flash-src/com/hurlant/crypto/tests/HMACTest.as", defaultSidebar = true;
  </script>
  <script src="../../../../../../../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>HMACTest.as</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<p>*
* HMACTest
* 
* A test class for HMAC
* Copyright (c) 2007 Henri Torgemane
* 
* See LICENSE.txt for full license information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">tests</span>
<span class="p">{</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">HMAC</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">MD5</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA1</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA224</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">SHA256</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Hex</span><span class="o">;</span>
  
  <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nb">ByteArray</span><span class="o">;</span>
  
  <span class="kd">public</span> <span class="kd">class</span> <span class="nx">HMACTest</span> <span class="kd">extends</span> <span class="nx">TestCase</span>
  <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">HMACTest</span><span class="p">(</span><span class="nx">h</span><span class="o">:</span><span class="nx">ITestHarness</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kd">super</span><span class="p">(</span><span class="nx">h</span><span class="o">,</span> <span class="s2">&quot;HMAC Test&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC_MD5</span><span class="o">,</span><span class="s2">&quot;HMAC MD5 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC_SHA_1</span><span class="o">,</span><span class="s2">&quot;HMAC SHA-1 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC_SHA_2</span><span class="o">,</span><span class="s2">&quot;HMAC SHA-224/SHA-256 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC96_MD5</span><span class="o">,</span><span class="s2">&quot;HMAC-96 MD5 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC96_SHA_1</span><span class="o">,</span><span class="s2">&quot;HMAC-96 SHA-1 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">runTest</span><span class="p">(</span><span class="nx">testHMAC128_SHA_2</span><span class="o">,</span><span class="s2">&quot;HMAC-128 SHA-224/SHA-256 Test Vectors&quot;</span><span class="p">);</span>
      <span class="nx">h</span><span class="p">.</span><span class="nx">endTestCase</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>*
* Test vectors taking from RFC2202
* <a href='http://tools.ietf.org/html/rfc2202'>http://tools.ietf.org/html/rfc2202</a>
* Yes, it's from an RFC, jefe! Now waddayawant?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC_SHA_1</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Jefe&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;0102030405060708090a0b0c0d0e0f10111213141516171819&quot;</span><span class="o">,</span>
      <span class="s2">&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="p">];</span>
      <span class="k">var</span> <span class="nx">pts</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Hi There&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;what do ya want for nothing?&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="s2">&quot;dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd&quot;</span><span class="o">,</span>
      <span class="s2">&quot;cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd&quot;</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test With Truncation&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data&quot;</span><span class="p">)];</span>
      <span class="k">var</span> <span class="nx">cts</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;b617318655057264e28bc0b6fb378c8ef146be00&quot;</span><span class="o">,</span>
      <span class="s2">&quot;effcdf6ae5eb2fa2d27416d5f184df9c259a7c79&quot;</span><span class="o">,</span>
      <span class="s2">&quot;125d7342b9ac11cd91a39af48aa17b4f63f175d3&quot;</span><span class="o">,</span> 
      <span class="s2">&quot;4c9007f4026250c6bc8414f9bf50c86c2d7235da&quot;</span><span class="o">,</span> 
      <span class="s2">&quot;4c1a03424b55e07fe7f27be1d58bb9324a9a5a04&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aa4ae5e15272d00e95705637ce8a3b55ed402112&quot;</span><span class="o">,</span>
      <span class="s2">&quot;e8e99d0f45237d786d6bbaa7965c7808bbff1a91&quot;</span><span class="p">];</span>
      
      <span class="k">var</span> <span class="nx">hmac</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA1</span><span class="p">());</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">pts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">digest</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC-SHA-1 test &quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest</span><span class="p">)</span> <span class="o">==</span> <span class="nx">cts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC96_SHA_1</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">hmac</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA1</span><span class="o">,</span> <span class="mi">96</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="s2">&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test With Truncation&quot;</span><span class="p">));</span>
      <span class="k">var</span> <span class="nx">ct</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;4c1a03424b55e07fe7f27be1&quot;</span><span class="o">;</span>
      <span class="k">var</span> <span class="nx">digest</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC96-SHA-1 test&quot;</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest</span><span class="p">)</span> <span class="o">==</span> <span class="nx">ct</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC_MD5</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Jefe&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="s2">&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;0102030405060708090a0b0c0d0e0f10111213141516171819&quot;</span><span class="o">,</span>
      <span class="s2">&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="p">];</span>
      <span class="k">var</span> <span class="nx">pts</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;what do ya want for nothing?&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Hi There&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="s2">&quot;dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd&quot;</span><span class="o">,</span>
      <span class="s2">&quot;cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd&quot;</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test With Truncation&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test Using Larger Than Block-Size Key - Hash Key First&quot;</span><span class="p">)</span><span class="o">,</span>
      <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data&quot;</span><span class="p">)];</span>
      <span class="k">var</span> <span class="nx">cts</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;750c783e6ab0b503eaa86e310a5db738&quot;</span><span class="o">,</span>
      <span class="s2">&quot;9294727a3638bb1c13f48ef8158bfc9d&quot;</span><span class="o">,</span>
      <span class="s2">&quot;56be34521d144c88dbb8c733f0e8b3f6&quot;</span><span class="o">,</span> 
      <span class="s2">&quot;697eaf0aca3a3aea3a75164746ffaa79&quot;</span><span class="o">,</span>
      <span class="s2">&quot;56461ef2342edc00f9bab995690efd4c&quot;</span><span class="o">,</span>
      <span class="s2">&quot;6b1ab7fe4bd7bf8f0b62e6ce61b9d0cd&quot;</span><span class="o">,</span>
      <span class="s2">&quot;6f630fad67cda0ee1fb1f562db3aa53e&quot;</span><span class="p">];</span>

      <span class="k">var</span> <span class="nx">hmac</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">MD5</span><span class="p">());</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">pts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">digest</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC-MD5 test &quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest</span><span class="p">)</span> <span class="o">==</span> <span class="nx">cts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC96_MD5</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">hmac</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">MD5</span><span class="o">,</span> <span class="mi">96</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="s2">&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s2">&quot;Test With Truncation&quot;</span><span class="p">));</span>
      <span class="k">var</span> <span class="nx">ct</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;56461ef2342edc00f9bab995&quot;</span><span class="o">;</span>
      <span class="k">var</span> <span class="nx">digest</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC96-MD5 test&quot;</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest</span><span class="p">)</span> <span class="o">==</span> <span class="nx">ct</span><span class="p">);</span>
    <span class="p">}</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>*
* Test vectors for HMAC-SHA-2 taken from RFC4231
* <a href='http://www.ietf.org/rfc/rfc4231.txt'>http://www.ietf.org/rfc/rfc4231.txt</a>
* Still the same lame strings, but hidden in hex. why not.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC_SHA_2</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">keys</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b&quot;</span><span class="o">,</span>
      <span class="s2">&quot;4a656665&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;0102030405060708090a0b0c0d0e0f10111213141516171819&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="o">,</span>
      <span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><span class="p">];</span>
      <span class="k">var</span> <span class="nx">pts</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;4869205468657265&quot;</span><span class="o">,</span>
      <span class="s2">&quot;7768617420646f2079612077616e7420666f72206e6f7468696e673f&quot;</span><span class="o">,</span>
      <span class="s2">&quot;dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd&quot;</span><span class="o">,</span>
      <span class="s2">&quot;cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd&quot;</span><span class="o">,</span>
      <span class="s2">&quot;54657374205573696e67204c6172676572205468616e20426c6f636b2d53697a65204b6579202d2048617368204b6579204669727374&quot;</span><span class="o">,</span>
      <span class="s2">&quot;5468697320697320612074657374207573696e672061206c6172676572207468616e20626c6f636b2d73697a65206b657920616e642061206c6172676572207468616e20626c6f636b2d73697a6520646174612e20546865206b6579206e6565647320746f20626520686173686564206265666f7265206265696e6720757365642062792074686520484d414320616c676f726974686d2e&quot;</span><span class="p">];</span>
      <span class="k">var</span> <span class="nx">cts224</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;896fb1128abbdf196832107cd49df33f47b4b1169912ba4f53684b22&quot;</span><span class="o">,</span>
      <span class="s2">&quot;a30e01098bc6dbbf45690f3a7e9e6d0f8bbea2a39e6148008fd05e44&quot;</span><span class="o">,</span>
      <span class="s2">&quot;7fb3cb3588c6c1f6ffa9694d7d6ad2649365b0c1f65d69d1ec8333ea&quot;</span><span class="o">,</span>
      <span class="s2">&quot;6c11506874013cac6a2abc1bb382627cec6a90d86efc012de7afec5a&quot;</span><span class="o">,</span>
      <span class="s2">&quot;95e9a0db962095adaebe9b2d6f0dbce2d499f112f2d2b7273fa6870e&quot;</span><span class="o">,</span>
      <span class="s2">&quot;3a854166ac5d9f023f54d517d0b39dbd946770db9c2b95c9f6f565d1&quot;</span><span class="p">];</span>
      <span class="k">var</span> <span class="nx">cts256</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;b0344c61d8db38535ca8afceaf0bf12b881dc200c9833da726e9376c2e32cff7&quot;</span><span class="o">,</span>
      <span class="s2">&quot;5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843&quot;</span><span class="o">,</span>
      <span class="s2">&quot;773ea91e36800e46854db8ebd09181a72959098b3ef8c122d9635514ced565fe&quot;</span><span class="o">,</span>
      <span class="s2">&quot;82558a389a443c0ea4cc819899f2083a85f0faa3e578f8077a2e3ff46729665b&quot;</span><span class="o">,</span>
      <span class="s2">&quot;60e431591ee0b67f0d8a26aacbf5b77f8e0bc6213728c5140546040f0ee37f54&quot;</span><span class="o">,</span>
      <span class="s2">&quot;9b09ffa71b942fcb27635fbcd5b0e944bfdc63644f0713938a7f51535c3a35e2&quot;</span><span class="p">];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>384 and 512 will be added. someday. if I ever figure how to do 64bit computations half efficiently in as3</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

      <span class="k">var</span> <span class="nx">hmac224</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA224</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">hmac256</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA256</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">pts</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">digest224</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac224</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC-SHA-224 test &quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest224</span><span class="p">)</span> <span class="o">==</span> <span class="nx">cts224</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">var</span> <span class="nx">digest256</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac256</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC-SHA-256 test &quot;</span><span class="o">+</span><span class="nx">i</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest256</span><span class="p">)</span> <span class="o">==</span> <span class="nx">cts256</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">testHMAC128_SHA_2</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
      <span class="k">var</span> <span class="nx">hmac224</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA224</span><span class="o">,</span><span class="mi">128</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">hmac256</span><span class="o">:</span><span class="nx">HMAC</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="nx">SHA256</span><span class="o">,</span><span class="mi">128</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="s2">&quot;0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c&quot;</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">pt</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="s2">&quot;546573742057697468205472756e636174696f6e&quot;</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">ct224</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;0e2aea68a90c8d37c988bcdb9fca6fa8&quot;</span><span class="o">;</span>
      <span class="k">var</span> <span class="nx">ct256</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;a3b6167473100ee06e0c796c2955552b&quot;</span><span class="o">;</span>
      <span class="k">var</span> <span class="nx">digest224</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac224</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC128-SHA-224 test&quot;</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest224</span><span class="p">)</span> <span class="o">==</span> <span class="nx">ct224</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">digest256</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="nx">hmac256</span><span class="p">.</span><span class="nx">compute</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="nx">pt</span><span class="p">);</span>
      <span class="nx">assert</span><span class="p">(</span><span class="s2">&quot;HMAC128-SHA-256 test&quot;</span><span class="o">,</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">(</span><span class="nx">digest256</span><span class="p">)</span> <span class="o">==</span> <span class="nx">ct256</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
