<!DOCTYPE html>
<html>
<head>
  <title>BlowFishKey.as</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../../../../../../../doc-style.css" />
  <script src="../../../../../../../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../../../../../../../", thisFile = "node_modules/socket.io/node_modules/socket.io-client/lib/vendor/web-socket-js/flash-src/com/hurlant/crypto/symmetric/BlowFishKey.as", defaultSidebar = true;
  </script>
  <script src="../../../../../../../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#useful-constants">Useful constants</a>
      </div>
      <div class="heading h1">
        <a href="#private-implementation">Private Implementation</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>BlowFishKey.as</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<p>*
* BlowFishKey
* 
* An Actionscript 3 implementation of the BlowFish encryption algorithm,
* as documented at <a href='http://www.schneier.com/blowfish.html'>http://www.schneier.com/blowfish.html</a>
* Copyright (c) 2007 Henri Torgemane
* 
* Derived from:
*     The Bouncy Castle Crypto package, 
*     Copyright (c) 2000-2004 The Legion Of The Bouncy Castle
*     (<a href='http://www.bouncycastle.org'>http://www.bouncycastle.org</a>)
* 
* See LICENSE.txt for full license information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">symmetric</span>
<span class="p">{</span>
  <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nb">ByteArray</span><span class="o">;</span>
  <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">hurlant</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Memory</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kd">class</span> <span class="nx">BlowFishKey</span> <span class="kd">implements</span> <span class="nx">ISymmetricKey</span>
  <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">KP</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x243</span><span class="nx">F6A88</span><span class="o">,</span> <span class="mh">0x85</span><span class="nx">A308D3</span><span class="o">,</span> <span class="mh">0x13198</span><span class="nx">A2E</span><span class="o">,</span> <span class="mh">0x03707344</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA4093822</span><span class="o">,</span> <span class="mh">0x299</span><span class="nx">F31D0</span><span class="o">,</span>
      <span class="mh">0x082</span><span class="nx">EFA98</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEC4E6C89</span><span class="o">,</span> <span class="mh">0x452821</span><span class="nx">E6</span><span class="o">,</span> <span class="mh">0x38</span><span class="nx">D01377</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBE5466CF</span><span class="o">,</span> <span class="mh">0x34</span><span class="nx">E90C6C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC0AC29B7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC97C50DD</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">F84D5B5</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB5470917</span><span class="o">,</span> <span class="mh">0x9216</span><span class="nx">D5D9</span><span class="o">,</span> <span class="mh">0x8979</span><span class="nx">FB1B</span> <span class="p">];</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">KS0</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="nx">xD1310BA6</span><span class="o">,</span> <span class="mh">0x98</span><span class="nx">DFB5AC</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">FFD72DB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD01ADFB7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB8E1AFED</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">A267E96</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBA7C9045</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF12C7F99</span><span class="o">,</span> <span class="mh">0x24</span><span class="nx">A19947</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB3916CF7</span><span class="o">,</span> <span class="mh">0x0801</span><span class="nx">F2E2</span><span class="o">,</span> <span class="mh">0x858</span><span class="nx">EFC16</span><span class="o">,</span> <span class="mh">0x636920</span><span class="nx">D8</span><span class="o">,</span> <span class="mh">0x71574</span><span class="nx">E69</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA458FEA3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF4933D7E</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">D95748F</span><span class="o">,</span> <span class="mh">0x728</span><span class="nx">EB658</span><span class="o">,</span>
      <span class="mh">0x718</span><span class="nx">BCD58</span><span class="o">,</span> <span class="mh">0x82154</span><span class="nx">AEE</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">B54A41D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC25A59B5</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">C30D539</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">AF26013</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC5D1B023</span><span class="o">,</span> <span class="mh">0x286085</span><span class="nx">F0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCA417918</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB8DB38EF</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">E79DCB0</span><span class="o">,</span> <span class="mh">0x603</span><span class="nx">A180E</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">C9E0E8B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB01E8A3E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD71577C1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBD314B27</span><span class="o">,</span> <span class="mh">0x78</span><span class="nx">AF2FDA</span><span class="o">,</span> <span class="mh">0x55605</span><span class="nx">C60</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xE65525F3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAA55AB94</span><span class="o">,</span> <span class="mh">0x57489862</span><span class="o">,</span> <span class="mh">0x63</span><span class="nx">E81440</span><span class="o">,</span> <span class="mh">0x55</span><span class="nx">CA396A</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">AAB10B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB4CC5C34</span><span class="o">,</span> <span class="mh">0x1141</span><span class="nx">E8CE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA15486AF</span><span class="o">,</span>
      <span class="mh">0x7</span><span class="nx">C72E993</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB3EE1411</span><span class="o">,</span> <span class="mh">0x636</span><span class="nx">FBC2A</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">BA9C55D</span><span class="o">,</span> <span class="mh">0x741831</span><span class="nx">F6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE5C3E16</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B87931E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAFD6BA33</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">C24CF5C</span><span class="o">,</span>
      <span class="mh">0x7</span><span class="nx">A325381</span><span class="o">,</span> <span class="mh">0x28958677</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B8F4898</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">B4BB9AF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC4BFE81B</span><span class="o">,</span> <span class="mh">0x66282193</span><span class="o">,</span> <span class="mh">0x61</span><span class="nx">D809CC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFB21A991</span><span class="o">,</span> <span class="mh">0x487</span><span class="nx">CAC60</span><span class="o">,</span>
      <span class="mh">0x5</span><span class="nx">DEC8032</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEF845D5D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE98575B1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDC262302</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEB651B88</span><span class="o">,</span> <span class="mh">0x23893</span><span class="nx">E81</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD396ACC5</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">F6D6FF3</span><span class="o">,</span> <span class="mh">0x83</span><span class="nx">F44239</span><span class="o">,</span>
      <span class="mh">0x2</span><span class="nx">E0B4482</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA4842004</span><span class="o">,</span> <span class="mh">0x69</span><span class="nx">C8F04A</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">E1F9B5E</span><span class="o">,</span> <span class="mh">0x21</span><span class="nx">C66842</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF6E96C9A</span><span class="o">,</span> <span class="mh">0x670</span><span class="nx">C9C61</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xABD388F0</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">A51A0D2</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD8542F68</span><span class="o">,</span> <span class="mh">0x960</span><span class="nx">FA728</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAB5133A3</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">EEF0B6C</span><span class="o">,</span> <span class="mh">0x137</span><span class="nx">A3BE4</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBA3BF050</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">EFB2A98</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1F1651D</span><span class="o">,</span> <span class="mh">0x39</span><span class="nx">AF0176</span><span class="o">,</span>
      <span class="mh">0x66</span><span class="nx">CA593E</span><span class="o">,</span> <span class="mh">0x82430</span><span class="nx">E88</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">CEE8619</span><span class="o">,</span> <span class="mh">0x456</span><span class="nx">F9FB4</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">D84A5C3</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B8B5EBE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE06F75D8</span><span class="o">,</span> <span class="mh">0x85</span><span class="nx">C12073</span><span class="o">,</span> <span class="mh">0x401</span><span class="nx">A449F</span><span class="o">,</span>
      <span class="mh">0x56</span><span class="nx">C16AA6</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">ED3AA62</span><span class="o">,</span> <span class="mh">0x363</span><span class="nx">F7706</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">BFEDF72</span><span class="o">,</span> <span class="mh">0x429</span><span class="nx">B023D</span><span class="o">,</span> <span class="mh">0x37</span><span class="nx">D0D724</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD00A1248</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB0FEAD3</span><span class="o">,</span> <span class="mh">0x49</span><span class="nx">F1C09B</span><span class="o">,</span>
      <span class="mh">0x075372</span><span class="nx">C9</span><span class="o">,</span> <span class="mh">0x80991</span><span class="nx">B7B</span><span class="o">,</span> <span class="mh">0x25</span><span class="nx">D479D8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF6E8DEF7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE3FE501A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB6794C3B</span><span class="o">,</span> <span class="mh">0x976</span><span class="nx">CE0BD</span><span class="o">,</span> <span class="mh">0x04</span><span class="nx">C006BA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC1A94FB6</span><span class="o">,</span>
      <span class="mh">0x409</span><span class="nx">F60C4</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">E5C9EC2</span><span class="o">,</span> <span class="mh">0x196</span><span class="nx">A2463</span><span class="o">,</span> <span class="mh">0x68</span><span class="nx">FB6FAF</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">E6C53B5</span><span class="o">,</span> <span class="mh">0x1339</span><span class="nx">B2EB</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B52EC6F</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">DFC511F</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B30952C</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xCC814544</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAF5EBD09</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBEE3D004</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDE334AFD</span><span class="o">,</span> <span class="mh">0x660</span><span class="nx">F2807</span><span class="o">,</span> <span class="mh">0x192</span><span class="nx">E4BB3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC0CBA857</span><span class="o">,</span> <span class="mh">0x45</span><span class="nx">C8740F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD20B5F39</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB9D3FBDB</span><span class="o">,</span> <span class="mh">0x5579</span><span class="nx">C0BD</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">A60320A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD6A100C6</span><span class="o">,</span> <span class="mh">0x402</span><span class="nx">C7279</span><span class="o">,</span> <span class="mh">0x679</span><span class="nx">F25FE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFB1FA3CC</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">EA5E9F8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB3222F8</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">C7516DF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFD616B15</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">F501EC8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAD0552AB</span><span class="o">,</span> <span class="mh">0x323</span><span class="nx">DB5FA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFD238760</span><span class="o">,</span> <span class="mh">0x53317</span><span class="nx">B48</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">E00DF82</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">E5C57BB</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xCA6F8CA0</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">A87562E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDF1769DB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD542A8F6</span><span class="o">,</span> <span class="mh">0x287</span><span class="nx">EFFC3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAC6732C6</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">C4F5573</span><span class="o">,</span> <span class="mh">0x695</span><span class="nx">B27B0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBBCA58C8</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xE1FFA35D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB8F011A0</span><span class="o">,</span> <span class="mh">0x10</span><span class="nx">FA3D98</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFD2183B8</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">AFCB56C</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">DD1D35B</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">A53E479</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB6F84565</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD28E49BC</span><span class="o">,</span>
      <span class="mh">0x4</span><span class="nx">BFB9790</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE1DDF2DA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA4CB7E33</span><span class="o">,</span> <span class="mh">0x62</span><span class="nx">FB1341</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCEE4C6E8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEF20CADA</span><span class="o">,</span> <span class="mh">0x36774</span><span class="nx">C01</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD07E9EFE</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">BF11FB4</span><span class="o">,</span>
      <span class="mh">0x95</span><span class="nx">DBDA4D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAE909198</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEAAD8E71</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">B93D5A0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD08ED1D0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAFC725E0</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">E3C5B2F</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">E7594B7</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">FF6E2FB</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xF2122B64</span><span class="o">,</span> <span class="mh">0x8888</span><span class="nx">B812</span><span class="o">,</span> <span class="mh">0x900</span><span class="nx">DF01C</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">FAD5EA0</span><span class="o">,</span> <span class="mh">0x688</span><span class="nx">FC31C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD1CFF191</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB3A8C1AD</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">F2F2218</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBE0E1777</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xEA752DFE</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">B021FA1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE5A0CC0F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB56F74E8</span><span class="o">,</span> <span class="mh">0x18</span><span class="nx">ACF3D6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE89E299</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB4A84FE0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFD13E0B7</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">CC43B81</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD2ADA8D9</span><span class="o">,</span> <span class="mh">0x165</span><span class="nx">FA266</span><span class="o">,</span> <span class="mh">0x80957705</span><span class="o">,</span> <span class="mh">0x93</span><span class="nx">CC7314</span><span class="o">,</span> <span class="mh">0x211</span><span class="nx">A1477</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE6AD2065</span><span class="o">,</span> <span class="mh">0x77</span><span class="nx">B5FA86</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC75442F5</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFB9D35CF</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xEBCDAF0C</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">B3E89A0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD6411BD3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAE1E7E49</span><span class="o">,</span> <span class="mh">0x00250</span><span class="nx">E2D</span><span class="o">,</span> <span class="mh">0x2071</span><span class="nx">B35E</span><span class="o">,</span> <span class="mh">0x226800</span><span class="nx">BB</span><span class="o">,</span> <span class="mh">0x57</span><span class="nx">B8E0AF</span><span class="o">,</span> <span class="mh">0x2464369</span><span class="nx">B</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xF009B91E</span><span class="o">,</span> <span class="mh">0x5563911</span><span class="nx">D</span><span class="o">,</span> <span class="mh">0x59</span><span class="nx">DFA6AA</span><span class="o">,</span> <span class="mh">0x78</span><span class="nx">C14389</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD95A537F</span><span class="o">,</span> <span class="mh">0x207</span><span class="nx">D5BA2</span><span class="o">,</span> <span class="mh">0x02</span><span class="nx">E5B9C5</span><span class="o">,</span> <span class="mh">0x83260376</span><span class="o">,</span> <span class="mh">0x6295</span><span class="nx">CFA9</span><span class="o">,</span>
      <span class="mh">0x11</span><span class="nx">C81968</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">E734A41</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB3472DCA</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">B14A94A</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">B510052</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">A532915</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD60F573F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBC9BC6E4</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">B60A476</span><span class="o">,</span>
      <span class="mh">0x81</span><span class="nx">E67400</span><span class="o">,</span> <span class="mh">0x08</span><span class="nx">BA6FB5</span><span class="o">,</span> <span class="mh">0x571</span><span class="nx">BE91F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF296EC6B</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">A0DD915</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB6636521</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE7B9F9B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFF34052E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC5855664</span><span class="o">,</span>
      <span class="mh">0x53</span><span class="nx">B02D5D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA99F8FA1</span><span class="o">,</span> <span class="mh">0x08</span><span class="nx">BA4799</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">E85076A</span> <span class="p">];</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">KS1</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x4</span><span class="nx">B7A70E9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB5B32944</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB75092E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC4192623</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAD6EA6B0</span><span class="o">,</span> <span class="mh">0x49</span><span class="nx">A7DF7D</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">CEE60B8</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">FEDB266</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xECAA8C71</span><span class="o">,</span>
      <span class="mh">0x699</span><span class="nx">A17FF</span><span class="o">,</span> <span class="mh">0x5664526</span><span class="nx">C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC2B19EE1</span><span class="o">,</span> <span class="mh">0x193602</span><span class="nx">A5</span><span class="o">,</span> <span class="mh">0x75094</span><span class="nx">C29</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA0591340</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE4183A3E</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">F54989A</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">B429D65</span><span class="o">,</span>
      <span class="mh">0x6</span><span class="nx">B8FE4D6</span><span class="o">,</span> <span class="mh">0x99</span><span class="nx">F73FD6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1D29C07</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEFE830F5</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">D2D38E6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF0255DC1</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">CDD2086</span><span class="o">,</span> <span class="mh">0x8470</span><span class="nx">EB26</span><span class="o">,</span> <span class="mh">0x6382</span><span class="nx">E9C6</span><span class="o">,</span>
      <span class="mh">0x021</span><span class="nx">ECC5E</span><span class="o">,</span> <span class="mh">0x09686</span><span class="nx">B3F</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">EBAEFC9</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">C971814</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">B6A70A1</span><span class="o">,</span> <span class="mh">0x687</span><span class="nx">F3584</span><span class="o">,</span> <span class="mh">0x52</span><span class="nx">A0E286</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB79C5305</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAA500737</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">E07841C</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">FDEAE5C</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">E7D44EC</span><span class="o">,</span> <span class="mh">0x5716</span><span class="nx">F2B8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB03ADA37</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF0500C0D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF01C1F04</span><span class="o">,</span> <span class="mh">0x0200</span><span class="nx">B3FF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAE0CF51A</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">CB574B2</span><span class="o">,</span> <span class="mh">0x25837</span><span class="nx">A58</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDC0921BD</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD19113F9</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">CA92FF6</span><span class="o">,</span> <span class="mh">0x94324773</span><span class="o">,</span> <span class="mh">0x22</span><span class="nx">F54701</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">AE5E581</span><span class="o">,</span> <span class="mh">0x37</span><span class="nx">C2DADC</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xC8B57634</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">AF3DDA7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA9446146</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">FD0030E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xECC8C73E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA4751E41</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE238CD99</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">BEA0E2F</span><span class="o">,</span> <span class="mh">0x3280</span><span class="nx">BBA1</span><span class="o">,</span>
      <span class="mh">0x183</span><span class="nx">EB331</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">E548B38</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">F6DB908</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">F420D03</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF60A04BF</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">CB81290</span><span class="o">,</span> <span class="mh">0x24977</span><span class="nx">C79</span><span class="o">,</span> <span class="mh">0x5679</span><span class="nx">B072</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBCAF89AF</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xDE9A771F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD9930810</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB38BAE12</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDCCF3F2E</span><span class="o">,</span> <span class="mh">0x5512721</span><span class="nx">F</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">E6B7124</span><span class="o">,</span> <span class="mh">0x501</span><span class="nx">ADDE6</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">F84CD87</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">A584718</span><span class="o">,</span>
      <span class="mh">0x7408</span><span class="nx">DA17</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBC9F9ABC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE94B7D8C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEC7AEC3A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB851DFA</span><span class="o">,</span> <span class="mh">0x63094366</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC464C3D2</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEF1C1847</span><span class="o">,</span> <span class="mh">0x3215</span><span class="nx">D908</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xDD433B37</span><span class="o">,</span> <span class="mh">0x24</span><span class="nx">C2BA16</span><span class="o">,</span> <span class="mh">0x12</span><span class="nx">A14D43</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">A65C451</span><span class="o">,</span> <span class="mh">0x50940002</span><span class="o">,</span> <span class="mh">0x133</span><span class="nx">AE4DD</span><span class="o">,</span> <span class="mh">0x71</span><span class="nx">DFF89E</span><span class="o">,</span> <span class="mh">0x10314</span><span class="nx">E55</span><span class="o">,</span> <span class="mh">0x81</span><span class="nx">AC77D6</span><span class="o">,</span>
      <span class="mh">0x5</span><span class="nx">F11199B</span><span class="o">,</span> <span class="mh">0x043556</span><span class="nx">F1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD7A3C76B</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">C11183B</span><span class="o">,</span> <span class="mh">0x5924</span><span class="nx">A509</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF28FE6ED</span><span class="o">,</span> <span class="mh">0x97</span><span class="nx">F1FBFA</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">EBABF2C</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">E153C6E</span><span class="o">,</span>
      <span class="mh">0x86</span><span class="nx">E34570</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEAE96FB1</span><span class="o">,</span> <span class="mh">0x860</span><span class="nx">E5E0A</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">A3E2AB3</span><span class="o">,</span> <span class="mh">0x771</span><span class="nx">FE71C</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">E3D06FA</span><span class="o">,</span> <span class="mh">0x2965</span><span class="nx">DCB9</span><span class="o">,</span> <span class="mh">0x99</span><span class="nx">E71D0F</span><span class="o">,</span> <span class="mh">0x803</span><span class="nx">E89D6</span><span class="o">,</span>
      <span class="mh">0x5266</span><span class="nx">C825</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">E4CC978</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">C10B36A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC6150EBA</span><span class="o">,</span> <span class="mh">0x94</span><span class="nx">E2EA78</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA5FC3C53</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">E0A2DF4</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF2F74EA7</span><span class="o">,</span> <span class="mh">0x361</span><span class="nx">D2B3D</span><span class="o">,</span>
      <span class="mh">0x1939260</span><span class="nx">F</span><span class="o">,</span> <span class="mh">0x19</span><span class="nx">C27960</span><span class="o">,</span> <span class="mh">0x5223</span><span class="nx">A708</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF71312B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEBADFE6E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEAC31F66</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE3BC4595</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA67BC883</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB17F37D1</span><span class="o">,</span>
      <span class="mh">0x018</span><span class="nx">CFF28</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC332DDEF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBE6C5AA5</span><span class="o">,</span> <span class="mh">0x65582185</span><span class="o">,</span> <span class="mh">0x68</span><span class="nx">AB9802</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEECEA50F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB2F953B</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">AEF7DAD</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">B6E2F84</span><span class="o">,</span>
      <span class="mh">0x1521</span><span class="nx">B628</span><span class="o">,</span> <span class="mh">0x29076170</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xECDD4775</span><span class="o">,</span> <span class="mh">0x619</span><span class="nx">F1510</span><span class="o">,</span> <span class="mh">0x13</span><span class="nx">CCA830</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEB61BD96</span><span class="o">,</span> <span class="mh">0x0334</span><span class="nx">FE1E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAA0363CF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB5735C90</span><span class="o">,</span>
      <span class="mh">0x4</span><span class="nx">C70A239</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD59E9E0B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCBAADE14</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEECC86BC</span><span class="o">,</span> <span class="mh">0x60622</span><span class="nx">CA7</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">CAB5CAB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB2F3846E</span><span class="o">,</span> <span class="mh">0x648</span><span class="nx">B1EAF</span><span class="o">,</span> <span class="mh">0x19</span><span class="nx">BDF0CA</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xA02369B9</span><span class="o">,</span> <span class="mh">0x655</span><span class="nx">ABB50</span><span class="o">,</span> <span class="mh">0x40685</span><span class="nx">A32</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">C2AB4B3</span><span class="o">,</span> <span class="mh">0x319</span><span class="nx">EE9D5</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC021B8F7</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B540B19</span><span class="o">,</span> <span class="mh">0x875</span><span class="nx">FA099</span><span class="o">,</span> <span class="mh">0x95</span><span class="nx">F7997E</span><span class="o">,</span>
      <span class="mh">0x623</span><span class="nx">D7DA8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF837889A</span><span class="o">,</span> <span class="mh">0x97</span><span class="nx">E32D77</span><span class="o">,</span> <span class="mh">0x11</span><span class="nx">ED935F</span><span class="o">,</span> <span class="mh">0x16681281</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">E358829</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC7E61FD6</span><span class="o">,</span> <span class="mh">0x96</span><span class="nx">DEDFA1</span><span class="o">,</span> <span class="mh">0x7858</span><span class="nx">BA99</span><span class="o">,</span>
      <span class="mh">0x57</span><span class="nx">F584A5</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">B227263</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B83C3FF</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">AC24696</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCDB30AEB</span><span class="o">,</span> <span class="mh">0x532</span><span class="nx">E3054</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">FD948E4</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">DBC3128</span><span class="o">,</span> <span class="mh">0x58</span><span class="nx">EBF2EF</span><span class="o">,</span>
      <span class="mh">0x34</span><span class="nx">C6FFEA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFE28ED61</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEE7C3C73</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">D4A14D9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE864B7E3</span><span class="o">,</span> <span class="mh">0x42105</span><span class="nx">D14</span><span class="o">,</span> <span class="mh">0x203</span><span class="nx">E13E0</span><span class="o">,</span> <span class="mh">0x45</span><span class="nx">EEE2B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA3AAABEA</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xDB6C4F15</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFACB4FD0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC742F442</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEF6ABBB5</span><span class="o">,</span> <span class="mh">0x654</span><span class="nx">F3B1D</span><span class="o">,</span> <span class="mh">0x41</span><span class="nx">CD2105</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD81E799E</span><span class="o">,</span> <span class="mh">0x86854</span><span class="nx">DC7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE44B476A</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">D816250</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCF62A1F2</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">B8D2646</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFC8883A0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC1C7B6A3</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">F1524C3</span><span class="o">,</span> <span class="mh">0x69</span><span class="nx">CB7492</span><span class="o">,</span> <span class="mh">0x47848</span><span class="nx">A0B</span><span class="o">,</span> <span class="mh">0x5692</span><span class="nx">B285</span><span class="o">,</span>
      <span class="mh">0x095</span><span class="nx">BBF00</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAD19489D</span><span class="o">,</span> <span class="mh">0x1462</span><span class="nx">B174</span><span class="o">,</span> <span class="mh">0x23820</span><span class="nx">E00</span><span class="o">,</span> <span class="mh">0x58428</span><span class="nx">D2A</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">C55F5EA</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">DADF43E</span><span class="o">,</span> <span class="mh">0x233</span><span class="nx">F7061</span><span class="o">,</span> <span class="mh">0x3372</span><span class="nx">F092</span><span class="o">,</span>
      <span class="mh">0x8</span><span class="nx">D937E41</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD65FECF1</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">C223BDB</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">CDE3759</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCBEE7460</span><span class="o">,</span> <span class="mh">0x4085</span><span class="nx">F2A7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE77326E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA6078084</span><span class="o">,</span> <span class="mh">0x19</span><span class="nx">F8509E</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xE8EFD855</span><span class="o">,</span> <span class="mh">0x61</span><span class="nx">D99735</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA969A7AA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC50C06C2</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">A04ABFC</span><span class="o">,</span> <span class="mh">0x800</span><span class="nx">BCADC</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">E447A2E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC3453484</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFDD56705</span><span class="o">,</span>
      <span class="mh">0x0</span><span class="nx">E1E9EC9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB73DBD3</span><span class="o">,</span> <span class="mh">0x105588</span><span class="nx">CD</span><span class="o">,</span> <span class="mh">0x675</span><span class="nx">FDA79</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE3674340</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC5C43465</span><span class="o">,</span> <span class="mh">0x713</span><span class="nx">E38D8</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">D28F89E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF16DFF20</span><span class="o">,</span>
      <span class="mh">0x153</span><span class="nx">E21E7</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">FB03D4A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE6E39F2B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB83ADF7</span> <span class="p">];</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">KS2</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="nx">xE93D5A68</span><span class="o">,</span> <span class="mh">0x948140</span><span class="nx">F7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF64C261C</span><span class="o">,</span> <span class="mh">0x94692934</span><span class="o">,</span> <span class="mh">0x411520</span><span class="nx">F7</span><span class="o">,</span> <span class="mh">0x7602</span><span class="nx">D4F7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBCF46B2E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD4A20068</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD4082471</span><span class="o">,</span>
      <span class="mh">0x3320</span><span class="nx">F46A</span><span class="o">,</span> <span class="mh">0x43</span><span class="nx">B7D4B7</span><span class="o">,</span> <span class="mh">0x500061</span><span class="nx">AF</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">E39F62E</span><span class="o">,</span> <span class="mh">0x97244546</span><span class="o">,</span> <span class="mh">0x14214</span><span class="nx">F74</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBF8B8840</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">D95FC1D</span><span class="o">,</span> <span class="mh">0x96</span><span class="nx">B591AF</span><span class="o">,</span>
      <span class="mh">0x70</span><span class="nx">F4DDD3</span><span class="o">,</span> <span class="mh">0x66</span><span class="nx">A02F45</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBFBC09EC</span><span class="o">,</span> <span class="mh">0x03</span><span class="nx">BD9785</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">FAC6DD0</span><span class="o">,</span> <span class="mh">0x31</span><span class="nx">CB8504</span><span class="o">,</span> <span class="mh">0x96</span><span class="nx">EB27B3</span><span class="o">,</span> <span class="mh">0x55</span><span class="nx">FD3941</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDA2547E6</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xABCA0A9A</span><span class="o">,</span> <span class="mh">0x28507825</span><span class="o">,</span> <span class="mh">0x530429</span><span class="nx">F4</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">A2C86DA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE9B66DFB</span><span class="o">,</span> <span class="mh">0x68</span><span class="nx">DC1462</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD7486900</span><span class="o">,</span> <span class="mh">0x680</span><span class="nx">EC0A4</span><span class="o">,</span> <span class="mh">0x27</span><span class="nx">A18DEE</span><span class="o">,</span>
      <span class="mh">0x4</span><span class="nx">F3FFEA2</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE887AD8C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB58CE006</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">AF4D6B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAACE1E7C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD3375FEC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE78A399</span><span class="o">,</span> <span class="mh">0x406</span><span class="nx">B2A42</span><span class="o">,</span> <span class="mh">0x20</span><span class="nx">FE9E35</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD9F385B9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEE39D7AB</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B124E8B</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">DC9FAF7</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">B6D1856</span><span class="o">,</span> <span class="mh">0x26</span><span class="nx">A36631</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEAE397B2</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">A6EFA74</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDD5B4332</span><span class="o">,</span>
      <span class="mh">0x6841</span><span class="nx">E7F7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCA7820FB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFB0AF54E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD8FEB397</span><span class="o">,</span> <span class="mh">0x454056</span><span class="nx">AC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBA489527</span><span class="o">,</span> <span class="mh">0x55533</span><span class="nx">A3A</span><span class="o">,</span> <span class="mh">0x20838</span><span class="nx">D87</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFE6BA9B7</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD096954B</span><span class="o">,</span> <span class="mh">0x55</span><span class="nx">A867BC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1159A58</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCCA92963</span><span class="o">,</span> <span class="mh">0x99</span><span class="nx">E1DB33</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA62A4A56</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">F3125F9</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">EF47E1C</span><span class="o">,</span> <span class="mh">0x9029317</span><span class="nx">C</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xFDF8E802</span><span class="o">,</span> <span class="mh">0x04272</span><span class="nx">F70</span><span class="o">,</span> <span class="mh">0x80</span><span class="nx">BB155C</span><span class="o">,</span> <span class="mh">0x05282</span><span class="nx">CE3</span><span class="o">,</span> <span class="mh">0x95</span><span class="nx">C11548</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE4C66D22</span><span class="o">,</span> <span class="mh">0x48</span><span class="nx">C1133F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC70F86DC</span><span class="o">,</span> <span class="mh">0x07</span><span class="nx">F9C9EE</span><span class="o">,</span>
      <span class="mh">0x41041</span><span class="nx">F0F</span><span class="o">,</span> <span class="mh">0x404779</span><span class="nx">A4</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">D886E17</span><span class="o">,</span> <span class="mh">0x325</span><span class="nx">F51EB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD59BC0D1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF2BCC18F</span><span class="o">,</span> <span class="mh">0x41113564</span><span class="o">,</span> <span class="mh">0x257</span><span class="nx">B7834</span><span class="o">,</span> <span class="mh">0x602</span><span class="nx">A9C60</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xDFF8E8A3</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">F636C1B</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">E12B4C2</span><span class="o">,</span> <span class="mh">0x02</span><span class="nx">E1329E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAF664FD1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCAD18115</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">B2395E0</span><span class="o">,</span> <span class="mh">0x333</span><span class="nx">E92E1</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B240B62</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xEEBEB922</span><span class="o">,</span> <span class="mh">0x85</span><span class="nx">B2A20E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE6BA0D99</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDE720C8C</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">DA2F728</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD0127845</span><span class="o">,</span> <span class="mh">0x95</span><span class="nx">B794FD</span><span class="o">,</span> <span class="mh">0x647</span><span class="nx">D0862</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE7CCF5F0</span><span class="o">,</span>
      <span class="mh">0x5449</span><span class="nx">A36F</span><span class="o">,</span> <span class="mh">0x877</span><span class="nx">D48FA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC39DFD27</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF33E8D1E</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">A476341</span><span class="o">,</span> <span class="mh">0x992</span><span class="nx">EFF74</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">A6F6EAB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF4F8FD37</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA812DC60</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xA1EBDDF8</span><span class="o">,</span> <span class="mh">0x991</span><span class="nx">BE14C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDB6E6B0D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC67B5510</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">D672C37</span><span class="o">,</span> <span class="mh">0x2765</span><span class="nx">D43B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDCD0E804</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF1290DC7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCC00FFA3</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB5390F92</span><span class="o">,</span> <span class="mh">0x690</span><span class="nx">FED0B</span><span class="o">,</span> <span class="mh">0x667</span><span class="nx">B9FFB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCEDB7D9C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA091CF0B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD9155EA3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBB132F88</span><span class="o">,</span> <span class="mh">0x515</span><span class="nx">BAD24</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">B9479BF</span><span class="o">,</span>
      <span class="mh">0x763</span><span class="nx">BD6EB</span><span class="o">,</span> <span class="mh">0x37392</span><span class="nx">EB3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCC115979</span><span class="o">,</span> <span class="mh">0x8026</span><span class="nx">E297</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF42E312D</span><span class="o">,</span> <span class="mh">0x6842</span><span class="nx">ADA7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC66A2B3B</span><span class="o">,</span> <span class="mh">0x12754</span><span class="nx">CCC</span><span class="o">,</span> <span class="mh">0x782</span><span class="nx">EF11C</span><span class="o">,</span>
      <span class="mh">0x6</span><span class="nx">A124237</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB79251E7</span><span class="o">,</span> <span class="mh">0x06</span><span class="nx">A1BBE6</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">BFB6350</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">A6B1018</span><span class="o">,</span> <span class="mh">0x11</span><span class="nx">CAEDFA</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">D25BDD8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE2E1C3C9</span><span class="o">,</span> <span class="mh">0x44421659</span><span class="o">,</span>
      <span class="mh">0x0</span><span class="nx">A121386</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD90CEC6E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD5ABEA2A</span><span class="o">,</span> <span class="mh">0x64</span><span class="nx">AF674E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDA86A85F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBEBFE988</span><span class="o">,</span> <span class="mh">0x64</span><span class="nx">E4C3FE</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">DBC8057</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF0F7C086</span><span class="o">,</span>
      <span class="mh">0x60787</span><span class="nx">BF8</span><span class="o">,</span> <span class="mh">0x6003604</span><span class="nx">D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD1FD8346</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF6381FB0</span><span class="o">,</span> <span class="mh">0x7745</span><span class="nx">AE04</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD736FCCC</span><span class="o">,</span> <span class="mh">0x83426</span><span class="nx">B33</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF01EAB71</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB0804187</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">C005E5F</span><span class="o">,</span> <span class="mh">0x77</span><span class="nx">A057BE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBDE8AE24</span><span class="o">,</span> <span class="mh">0x55464299</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBF582E61</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">E58F48F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF2DDFDA2</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF474EF38</span><span class="o">,</span> <span class="mh">0x8789</span><span class="nx">BDC2</span><span class="o">,</span>
      <span class="mh">0x5366</span><span class="nx">F9C3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC8B38E74</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB475F255</span><span class="o">,</span> <span class="mh">0x46</span><span class="nx">FCD9B9</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">AEB2661</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">B1DDF84</span><span class="o">,</span> <span class="mh">0x846</span><span class="nx">A0E79</span><span class="o">,</span> <span class="mh">0x915</span><span class="nx">F95E2</span><span class="o">,</span> <span class="mh">0x466</span><span class="nx">E598E</span><span class="o">,</span>
      <span class="mh">0x20</span><span class="nx">B45770</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">CD55591</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC902DE4C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB90BACE1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBB8205D0</span><span class="o">,</span> <span class="mh">0x11</span><span class="nx">A86248</span><span class="o">,</span> <span class="mh">0x7574</span><span class="nx">A99E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB77F19B6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE0A9DC09</span><span class="o">,</span>
      <span class="mh">0x662</span><span class="nx">D09A1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC4324633</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE85A1F02</span><span class="o">,</span> <span class="mh">0x09</span><span class="nx">F0BE8C</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">A99A025</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">D6EFE10</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">AB93D1D</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">BA5A4DF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA186F20F</span><span class="o">,</span>
      <span class="mh">0x2868</span><span class="nx">F169</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDCB7DA83</span><span class="o">,</span> <span class="mh">0x573906</span><span class="nx">FE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1E2CE9B</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">FCD7F52</span><span class="o">,</span> <span class="mh">0x50115</span><span class="nx">E01</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA70683FA</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA002B5C4</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">DE6D027</span><span class="o">,</span>
      <span class="mh">0x9</span><span class="nx">AF88C27</span><span class="o">,</span> <span class="mh">0x773</span><span class="nx">F8641</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC3604C06</span><span class="o">,</span> <span class="mh">0x61</span><span class="nx">A806B5</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF0177A28</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC0F586E0</span><span class="o">,</span> <span class="mh">0x006058</span><span class="nx">AA</span><span class="o">,</span> <span class="mh">0x30</span><span class="nx">DC7D62</span><span class="o">,</span> <span class="mh">0x11</span><span class="nx">E69ED7</span><span class="o">,</span>
      <span class="mh">0x2338</span><span class="nx">EA63</span><span class="o">,</span> <span class="mh">0x53</span><span class="nx">C2DD94</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC2C21634</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBBCBEE56</span><span class="o">,</span> <span class="mh">0x90</span><span class="nx">BCB6DE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEBFC7DA1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE591D76</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">F05E409</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">B7C0188</span><span class="o">,</span>
      <span class="mh">0x39720</span><span class="nx">A3D</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">C927C24</span><span class="o">,</span> <span class="mh">0x86</span><span class="nx">E3725F</span><span class="o">,</span> <span class="mh">0x724</span><span class="nx">D9DB9</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">AC15BB4</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD39EB8FC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xED545578</span><span class="o">,</span> <span class="mh">0x08</span><span class="nx">FCA5B5</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD83D7CD3</span><span class="o">,</span>
      <span class="mh">0x4</span><span class="nx">DAD0FC4</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">E50EF5E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB161E6F8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA28514D9</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">C51133C</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">FD5C7E7</span><span class="o">,</span> <span class="mh">0x56</span><span class="nx">E14EC4</span><span class="o">,</span> <span class="mh">0x362</span><span class="nx">ABFCE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDDC6C837</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD79A3234</span><span class="o">,</span> <span class="mh">0x92638212</span><span class="o">,</span> <span class="mh">0x670</span><span class="nx">EFA8E</span><span class="o">,</span> <span class="mh">0x406000</span><span class="nx">E0</span> <span class="p">];</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">KS3</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x3</span><span class="nx">A39CE37</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD3FAF5CF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xABC27737</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">AC52D1B</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">CB0679E</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">FA33742</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD3822740</span><span class="o">,</span> <span class="mh">0x99</span><span class="nx">BC9BBE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD5118E9D</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xBF0F7315</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD62D1C7E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC700C47B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB78C1B6B</span><span class="o">,</span> <span class="mh">0x21</span><span class="nx">A19045</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB26EB1BE</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">A366EB4</span><span class="o">,</span> <span class="mh">0x5748</span><span class="nx">AB2F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBC946E79</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xC6A376D2</span><span class="o">,</span> <span class="mh">0x6549</span><span class="nx">C2C8</span><span class="o">,</span> <span class="mh">0x530</span><span class="nx">FF8EE</span><span class="o">,</span> <span class="mh">0x468</span><span class="nx">DDE7D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD5730A1D</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">CD04DC6</span><span class="o">,</span> <span class="mh">0x2939</span><span class="nx">BBDB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA9BA4650</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAC9526E8</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xBE5EE304</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1FAD5F0</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">A2D519A</span><span class="o">,</span> <span class="mh">0x63</span><span class="nx">EF8CE2</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">A86EE22</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC089C2B8</span><span class="o">,</span> <span class="mh">0x43242</span><span class="nx">EF6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA51E03AA</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">CF2D0A4</span><span class="o">,</span>
      <span class="mh">0x83</span><span class="nx">C061BA</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">BE96A4D</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">FE51550</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBA645BD6</span><span class="o">,</span> <span class="mh">0x2826</span><span class="nx">A2F9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA73A3AE1</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">BA99586</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEF5562E9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC72FEFD3</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xF752F7DA</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">F046F69</span><span class="o">,</span> <span class="mh">0x77</span><span class="nx">FA0A59</span><span class="o">,</span> <span class="mh">0x80</span><span class="nx">E4A915</span><span class="o">,</span> <span class="mh">0x87</span><span class="nx">B08601</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B09E6AD</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">B3EE593</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE990FD5A</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">E34D797</span><span class="o">,</span>
      <span class="mh">0x2</span><span class="nx">CF0B7D9</span><span class="o">,</span> <span class="mh">0x022</span><span class="nx">B8B51</span><span class="o">,</span> <span class="mh">0x96</span><span class="nx">D5AC3A</span><span class="o">,</span> <span class="mh">0x017</span><span class="nx">DA67D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD1CF3ED6</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">C7D2D28</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">F9F25CF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xADF2B89B</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">AD6B472</span><span class="o">,</span>
      <span class="mh">0x5</span><span class="nx">A88F54C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE029AC71</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE019A5E6</span><span class="o">,</span> <span class="mh">0x47</span><span class="nx">B0ACFD</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xED93FA9B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE8D3C48D</span><span class="o">,</span> <span class="mh">0x283</span><span class="nx">B57CC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF8D56629</span><span class="o">,</span> <span class="mh">0x79132</span><span class="nx">E28</span><span class="o">,</span>
      <span class="mh">0x785</span><span class="nx">F0191</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xED756055</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF7960E44</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE3D35E8C</span><span class="o">,</span> <span class="mh">0x15056</span><span class="nx">DD4</span><span class="o">,</span> <span class="mh">0x88</span><span class="nx">F46DBA</span><span class="o">,</span> <span class="mh">0x03</span><span class="nx">A16125</span><span class="o">,</span> <span class="mh">0x0564</span><span class="nx">F0BD</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC3EB9E15</span><span class="o">,</span>
      <span class="mh">0x3</span><span class="nx">C9057A2</span><span class="o">,</span> <span class="mh">0x97271</span><span class="nx">AEC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA93A072A</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">B3F6D9B</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">E6321F5</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF59C66FB</span><span class="o">,</span> <span class="mh">0x26</span><span class="nx">DCF319</span><span class="o">,</span> <span class="mh">0x7533</span><span class="nx">D928</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB155FDF5</span><span class="o">,</span>
      <span class="mh">0x03563482</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">ABA3CBB</span><span class="o">,</span> <span class="mh">0x28517711</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC20AD9F8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xABCC5167</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCCAD925F</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">DE81751</span><span class="o">,</span> <span class="mh">0x3830</span><span class="nx">DC8E</span><span class="o">,</span> <span class="mh">0x379</span><span class="nx">D5862</span><span class="o">,</span>
      <span class="mh">0x9320</span><span class="nx">F991</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xEA7A90C2</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFB3E7BCE</span><span class="o">,</span> <span class="mh">0x5121</span><span class="nx">CE64</span><span class="o">,</span> <span class="mh">0x774</span><span class="nx">FBE32</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA8B6E37E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC3293D46</span><span class="o">,</span> <span class="mh">0x48</span><span class="nx">DE5369</span><span class="o">,</span> <span class="mh">0x6413</span><span class="nx">E680</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xA2AE0810</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDD6DB224</span><span class="o">,</span> <span class="mh">0x69852</span><span class="nx">DFD</span><span class="o">,</span> <span class="mh">0x09072166</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB39A460A</span><span class="o">,</span> <span class="mh">0x6445</span><span class="nx">C0DD</span><span class="o">,</span> <span class="mh">0x586</span><span class="nx">CDECF</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">C20C8AE</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">BBEF7DD</span><span class="o">,</span>
      <span class="mh">0x1</span><span class="nx">B588D40</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCCD2017F</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">BB4E3BB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDDA26A7E</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">A59FF45</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">E350A44</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBCB4CDD5</span><span class="o">,</span> <span class="mh">0x72</span><span class="nx">EACEA8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFA6484BB</span><span class="o">,</span>
      <span class="mh">0x8</span><span class="nx">D6612AE</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBF3C6F47</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD29BE463</span><span class="o">,</span> <span class="mh">0x542</span><span class="nx">F5D9E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xAEC2771B</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF64E6370</span><span class="o">,</span> <span class="mh">0x740</span><span class="nx">E0D8D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE75B1357</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF8721671</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xAF537D5D</span><span class="o">,</span> <span class="mh">0x4040</span><span class="nx">CB08</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">EB4E2CC</span><span class="o">,</span> <span class="mh">0x34</span><span class="nx">D2466A</span><span class="o">,</span> <span class="mh">0x0115</span><span class="nx">AF84</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE1B00428</span><span class="o">,</span> <span class="mh">0x95983</span><span class="nx">A1D</span><span class="o">,</span> <span class="mh">0x06</span><span class="nx">B89FB4</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE6EA048</span><span class="o">,</span>
      <span class="mh">0x6</span><span class="nx">F3F3B82</span><span class="o">,</span> <span class="mh">0x3520</span><span class="nx">AB82</span><span class="o">,</span> <span class="mh">0x011</span><span class="nx">A1D4B</span><span class="o">,</span> <span class="mh">0x277227</span><span class="nx">F8</span><span class="o">,</span> <span class="mh">0x611560</span><span class="nx">B1</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE7933FDC</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBB3A792B</span><span class="o">,</span> <span class="mh">0x344525</span><span class="nx">BD</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA08839E1</span><span class="o">,</span>
      <span class="mh">0x51</span><span class="nx">CE794B</span><span class="o">,</span> <span class="mh">0x2</span><span class="nx">F32C9B7</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA01FBAC9</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE01CC87E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBCC7D1F6</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCF0111C3</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA1E8AAC7</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">A908749</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD44FBD9A</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xD0DADECB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD50ADA38</span><span class="o">,</span> <span class="mh">0x0339</span><span class="nx">C32A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC6913667</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">DF9317C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE0B12B4F</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF79E59B7</span><span class="o">,</span> <span class="mh">0x43</span><span class="nx">F5BB3A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF2D519FF</span><span class="o">,</span>
      <span class="mh">0x27</span><span class="nx">D9459C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBF97222C</span><span class="o">,</span> <span class="mh">0x15</span><span class="nx">E6FC2A</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">F91FC71</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B941525</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFAE59361</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCEB69CEB</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC2A86459</span><span class="o">,</span> <span class="mh">0x12</span><span class="nx">BAA8D1</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB6C1075E</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE3056A0C</span><span class="o">,</span> <span class="mh">0x10</span><span class="nx">D25065</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCB03A442</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE0EC6E0E</span><span class="o">,</span> <span class="mh">0x1698</span><span class="nx">DB3B</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">C98A0BE</span><span class="o">,</span> <span class="mh">0x3278</span><span class="nx">E964</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">F1F9532</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xE0D392DF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD3A0342B</span><span class="o">,</span> <span class="mh">0x8971</span><span class="nx">F21E</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">B0A7441</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">BA3348C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC5BE7120</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC37632D8</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xDF359F8D</span><span class="o">,</span> <span class="mh">0x9</span><span class="nx">B992F2E</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xE60B6F47</span><span class="o">,</span> <span class="mh">0x0</span><span class="nx">FE3F11D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE54CDA54</span><span class="o">,</span> <span class="mh">0x1</span><span class="nx">EDAD891</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE6279CF</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCD3E7E6F</span><span class="o">,</span> <span class="mh">0x1618</span><span class="nx">B166</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xFD2C1D05</span><span class="o">,</span> <span class="mh">0x848</span><span class="nx">FD2C5</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xF6FB2299</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF523F357</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA6327623</span><span class="o">,</span> <span class="mh">0x93</span><span class="nx">A83531</span><span class="o">,</span> <span class="mh">0x56</span><span class="nx">CCCD02</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xACF08162</span><span class="o">,</span> <span class="mh">0x5</span><span class="nx">A75EBB5</span><span class="o">,</span> <span class="mh">0x6</span><span class="nx">E163697</span><span class="o">,</span> <span class="mh">0x88</span><span class="nx">D273CC</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xDE966292</span><span class="o">,</span> <span class="mh">0x81</span><span class="nx">B949D0</span><span class="o">,</span> <span class="mh">0x4</span><span class="nx">C50901B</span><span class="o">,</span> <span class="mh">0x71</span><span class="nx">C65614</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xE6C6C7BD</span><span class="o">,</span> <span class="mh">0x327</span><span class="nx">A140A</span><span class="o">,</span> <span class="mh">0x45</span><span class="nx">E1D006</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC3F27B9A</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC9AA53FD</span><span class="o">,</span>
      <span class="mh">0x62</span><span class="nx">A80F00</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBB25BFE2</span><span class="o">,</span> <span class="mh">0x35</span><span class="nx">BDD2F6</span><span class="o">,</span> <span class="mh">0x71126905</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB2040222</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xB6CBCF7C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCD769C2B</span><span class="o">,</span> <span class="mh">0x53113</span><span class="nx">EC0</span><span class="o">,</span> <span class="mh">0x1640</span><span class="nx">E3D3</span><span class="o">,</span>
      <span class="mh">0x38</span><span class="nx">ABBD60</span><span class="o">,</span> <span class="mh">0x2547</span><span class="nx">ADF0</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xBA38209C</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xF746CE76</span><span class="o">,</span> <span class="mh">0x77</span><span class="nx">AFA1C5</span><span class="o">,</span> <span class="mh">0x20756060</span><span class="o">,</span> <span class="mh">0x85</span><span class="nx">CBFE4E</span><span class="o">,</span> <span class="mh">0x8</span><span class="nx">AE88DD8</span><span class="o">,</span> <span class="mh">0x7</span><span class="nx">AAAF9B0</span><span class="o">,</span>
      <span class="mh">0x4</span><span class="nx">CF9AA7E</span><span class="o">,</span> <span class="mh">0x1948</span><span class="nx">C25C</span><span class="o">,</span> <span class="mh">0x02</span><span class="nx">FB8A8C</span><span class="o">,</span> <span class="mh">0x01</span><span class="nx">C36AE4</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xD6EBE1F9</span><span class="o">,</span> <span class="mh">0x90</span><span class="nx">D4F869</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xA65CDEA0</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">F09252D</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xC208E69F</span><span class="o">,</span>
      <span class="mi">0</span><span class="nx">xB74E6132</span><span class="o">,</span> <span class="mi">0</span><span class="nx">xCE77E25B</span><span class="o">,</span> <span class="mh">0x578</span><span class="nx">FDFE3</span><span class="o">,</span> <span class="mh">0x3</span><span class="nx">AC372E6</span> <span class="p">];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><p>====================================</p>


<div class="pilwrap" id="useful-constants">
  <h1>
    <a href="#useful-constants" class="pilcrow">&#182;</a>
    Useful constants
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">ROUNDS</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">BLOCK_SIZE</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">8</span><span class="o">;</span> <span class="c1">// bytes = 64 bits</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">SBOX_SK</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">256</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">const</span> <span class="nx">P_SZ</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">ROUNDS</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
  
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">S0</span><span class="o">:</span><span class="nb">Array</span><span class="o">;</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">S1</span><span class="o">:</span><span class="nb">Array</span><span class="o">;</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">S2</span><span class="o">:</span><span class="nb">Array</span><span class="o">;</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">S3</span><span class="o">:</span><span class="nb">Array</span><span class="o">;</span> <span class="c1">// the s-boxes</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">P</span><span class="o">:</span><span class="nb">Array</span><span class="o">;</span> <span class="c1">// the p-array</span>
  
    <span class="kd">private</span> <span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">BlowFishKey</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="o">;</span>
      <span class="nx">setKey</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">getBlockSize</span><span class="p">()</span><span class="o">:</span><span class="nb">uint</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">BLOCK_SIZE</span><span class="o">;</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">decrypt</span><span class="p">(</span><span class="nx">block</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">index</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="nx">decryptBlock</span><span class="p">(</span><span class="nx">block</span><span class="o">,</span> <span class="nx">index</span><span class="o">,</span> <span class="nx">block</span><span class="o">,</span> <span class="nx">index</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">dispose</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">S0</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">S0</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">S1</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">S1</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">S2</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">S2</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">S3</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">S3</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">P</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="p">}</span>
      <span class="nx">S0</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="nx">S1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="nx">S2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="nx">S3</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="nx">P</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">key</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">key</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
      <span class="p">}</span>
      <span class="nx">key</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="nx">key</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="nx">Memory</span><span class="p">.</span><span class="nx">gc</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">encrypt</span><span class="p">(</span><span class="nx">block</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">index</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="nx">encryptBlock</span><span class="p">(</span><span class="nx">block</span><span class="o">,</span> <span class="nx">index</span><span class="o">,</span> <span class="nx">block</span><span class="o">,</span> <span class="nx">index</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><p>==================================</p>


<div class="pilwrap" id="private-implementation">
  <h1>
    <a href="#private-implementation" class="pilcrow">&#182;</a>
    Private Implementation
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
  
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="nb">uint</span><span class="p">)</span><span class="o">:</span><span class="nb">uint</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="p">(((</span><span class="nx">S0</span><span class="p">[(</span><span class="nx">x</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">24</span><span class="p">)]</span> <span class="o">+</span> <span class="nx">S1</span><span class="p">[(</span><span class="nx">x</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">])</span> <span class="o">^</span> <span class="nx">S2</span><span class="p">[(</span><span class="nx">x</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">])</span> <span class="o">+</span> <span class="nx">S3</span><span class="p">[</span><span class="nx">x</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">]);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>*
* apply the encryption cycle to each value pair in the table.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">processTable</span><span class="p">(</span><span class="nx">xl</span><span class="o">:</span><span class="nb">uint</span><span class="o">,</span> <span class="nx">xr</span><span class="o">:</span><span class="nb">uint</span><span class="o">,</span> <span class="nx">table</span><span class="o">:</span><span class="nb">Array</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="k">var</span> <span class="nx">size</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span>
  
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">s</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">s</span> <span class="o">&lt;</span> <span class="nx">size</span><span class="o">;</span> <span class="nx">s</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  
        <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ROUNDS</span><span class="o">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xl</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
          <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xr</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
  
        <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="nx">ROUNDS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
  
        <span class="nx">table</span><span class="p">[</span><span class="nx">s</span><span class="p">]</span> <span class="o">=</span> <span class="nx">xr</span><span class="o">;</span>
        <span class="nx">table</span><span class="p">[</span><span class="nx">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">xl</span><span class="o">;</span>
  
        <span class="nx">xr</span> <span class="o">=</span> <span class="nx">xl</span><span class="o">;</span> <span class="c1">// end of cycle swap</span>
        <span class="nx">xl</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nx">s</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">setKey</span><span class="p">(</span><span class="nx">key</span><span class="o">:</span><span class="nb">ByteArray</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<ul>
<li><ul><li>comments are from <em>Applied Crypto</em>, Schneier, p338 please be</li></ul></li>
<li>careful comparing the two, AC numbers the arrays from 1, the enclosed</li>
<li>code from 0.</li>
<li>
<ul><li>(1) Initialise the S-boxes and the P-array, with a fixed string This</li></ul></li>
<li>string contains the hexadecimal digits of pi (3.141...)</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nx">S0</span> <span class="o">=</span> <span class="nx">KS0</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
      <span class="nx">S1</span> <span class="o">=</span> <span class="nx">KS1</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
      <span class="nx">S2</span> <span class="o">=</span> <span class="nx">KS2</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
      <span class="nx">S3</span> <span class="o">=</span> <span class="nx">KS3</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
      <span class="nx">P</span> <span class="o">=</span> <span class="nx">KP</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<ul>
<li>(2) Now, XOR P[0] with the first 32 bits of the key, XOR P[1] with</li>
<li>the second 32-bits of the key, and so on for all bits of the key (up</li>
<li>to P[17]). Repeatedly cycle through the key bits until the entire</li>
<li>P-array has been XOR-ed with the key bits</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">var</span> <span class="nx">keyLength</span><span class="o">:</span><span class="nb">uint</span><span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span>
      <span class="k">var</span> <span class="nx">keyIndex</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">P_SZ</span><span class="o">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
      <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>get the 32 bits of the key, in 4 * 8 bit chunks</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">var</span> <span class="nx">data</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mh">0x0000000</span><span class="o">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">j</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="o">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>create a 32 bit block</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">key</span><span class="p">[</span><span class="nx">keyIndex</span><span class="o">++</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">);</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>wrap when we get to the end of the key</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="k">if</span> <span class="p">(</span><span class="nx">keyIndex</span> <span class="o">&gt;=</span> <span class="nx">keyLength</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="nx">keyIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
          <span class="p">}</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>XOR the newly created 32 bit chunk onto the P-array</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">P</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">^=</span> <span class="nx">data</span><span class="o">;</span>
      <span class="p">}</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<ul>
<li>(3) Encrypt the all-zero string with the Blowfish algorithm, using</li>
<li>the subkeys described in (1) and (2)</li>
<li>
<ul><li>(4) Replace P1 and P2 with the output of step (3)</li></ul></li>
<li>
<ul><li>(5) Encrypt the output of step(3) using the Blowfish algorithm, with</li></ul></li>
<li>the modified subkeys.</li>
<li>
<ul><li>(6) Replace P3 and P4 with the output of step (5)</li></ul></li>
<li>
<ul><li>(7) Continue the process, replacing all elements of the P-array and</li></ul></li>
<li>then all four S-boxes in order, with the output of the continuously</li>
<li>changing Blowfish algorithm</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  
      <span class="nx">processTable</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">P</span><span class="p">);</span>
      <span class="nx">processTable</span><span class="p">(</span><span class="nx">P</span><span class="p">[</span><span class="nx">P_SZ</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span><span class="o">,</span> <span class="nx">P</span><span class="p">[</span><span class="nx">P_SZ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">,</span> <span class="nx">S0</span><span class="p">);</span>
      <span class="nx">processTable</span><span class="p">(</span><span class="nx">S0</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span><span class="o">,</span> <span class="nx">S0</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">,</span> <span class="nx">S1</span><span class="p">);</span>
      <span class="nx">processTable</span><span class="p">(</span><span class="nx">S1</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span><span class="o">,</span> <span class="nx">S1</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">,</span> <span class="nx">S2</span><span class="p">);</span>
      <span class="nx">processTable</span><span class="p">(</span><span class="nx">S2</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span><span class="o">,</span> <span class="nx">S2</span><span class="p">[</span><span class="nx">SBOX_SK</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">,</span> <span class="nx">S3</span><span class="p">);</span>
    <span class="p">}</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>*
* Encrypt the given input starting at the given offset and place the result
* in the provided buffer starting at the given offset. The input will be an
* exact multiple of our blocksize.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">encryptBlock</span><span class="p">(</span><span class="nx">src</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">srcIndex</span><span class="o">:</span><span class="nb">uint</span><span class="o">,</span> <span class="nx">dst</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">dstIndex</span><span class="o">:</span><span class="nb">uint</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="k">var</span> <span class="nx">xl</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">BytesTo32bits</span><span class="p">(</span><span class="nx">src</span><span class="o">,</span> <span class="nx">srcIndex</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">xr</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">BytesTo32bits</span><span class="p">(</span><span class="nx">src</span><span class="o">,</span> <span class="nx">srcIndex</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
  
      <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ROUNDS</span><span class="o">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xl</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xr</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
  
      <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="nx">ROUNDS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
  
      <span class="nx">Bits32ToBytes</span><span class="p">(</span><span class="nx">xr</span><span class="o">,</span> <span class="nx">dst</span><span class="o">,</span> <span class="nx">dstIndex</span><span class="p">);</span>
      <span class="nx">Bits32ToBytes</span><span class="p">(</span><span class="nx">xl</span><span class="o">,</span> <span class="nx">dst</span><span class="o">,</span> <span class="nx">dstIndex</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
    <span class="p">}</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>*
* Decrypt the given input starting at the given offset and place the result
* in the provided buffer starting at the given offset. The input will be an
* exact multiple of our blocksize.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">decryptBlock</span><span class="p">(</span><span class="nx">src</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">srcIndex</span><span class="o">:</span><span class="nb">uint</span><span class="o">,</span> <span class="nx">dst</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">dstIndex</span><span class="o">:</span><span class="nb">uint</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="k">var</span> <span class="nx">xl</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">BytesTo32bits</span><span class="p">(</span><span class="nx">src</span><span class="o">,</span> <span class="nx">srcIndex</span><span class="p">);</span>
      <span class="k">var</span> <span class="nx">xr</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">BytesTo32bits</span><span class="p">(</span><span class="nx">src</span><span class="o">,</span> <span class="nx">srcIndex</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
  
      <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="nx">ROUNDS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
  
      <span class="k">for</span> <span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span> <span class="o">=</span> <span class="nx">ROUNDS</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">-=</span> <span class="mi">2</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xl</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">xl</span> <span class="o">^=</span> <span class="nx">F</span><span class="p">(</span><span class="nx">xr</span><span class="p">)</span> <span class="o">^</span> <span class="nx">P</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
  
      <span class="nx">xr</span> <span class="o">^=</span> <span class="nx">P</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  
      <span class="nx">Bits32ToBytes</span><span class="p">(</span><span class="nx">xr</span><span class="o">,</span> <span class="nx">dst</span><span class="o">,</span> <span class="nx">dstIndex</span><span class="p">);</span>
      <span class="nx">Bits32ToBytes</span><span class="p">(</span><span class="nx">xl</span><span class="o">,</span> <span class="nx">dst</span><span class="o">,</span> <span class="nx">dstIndex</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
    <span class="p">}</span>
  
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">BytesTo32bits</span><span class="p">(</span><span class="nx">b</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="p">)</span><span class="o">:</span><span class="nb">uint</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="p">((</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">b</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">));</span>
    <span class="p">}</span>
  
    <span class="kd">private</span> <span class="kd">function</span> <span class="nx">Bits32ToBytes</span><span class="p">(</span><span class="nx">i</span><span class="o">:</span><span class="nb">uint</span><span class="o">,</span> <span class="nx">b</span><span class="o">:</span><span class="nb">ByteArray</span><span class="o">,</span> <span class="nx">offset</span><span class="o">:</span><span class="nb">uint</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
    <span class="p">{</span>
      <span class="nx">b</span><span class="p">[</span><span class="nx">offset</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span><span class="o">;</span>
      <span class="nx">b</span><span class="p">[</span><span class="nx">offset</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">);</span>
      <span class="nx">b</span><span class="p">[</span><span class="nx">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">);</span>
      <span class="nx">b</span><span class="p">[</span><span class="nx">offset</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">public</span> <span class="kd">function</span> <span class="nx">toString</span><span class="p">()</span><span class="o">:</span><span class="nb">String</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&quot;blowfish&quot;</span><span class="o">;</span>
    <span class="p">}</span>
  
  <span class="p">}</span>
    
<span class="p">}</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
